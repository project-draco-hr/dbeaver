{
  initExporter(session.getProgressMonitor());
  DBCResultSetMetaData metaData=resultSet.getResultSetMetaData();
  List<DBCAttributeMetaData> rsAttributes=metaData.getAttributes();
  columnMappings=new ColumnMapping[rsAttributes.size()];
  DBSEntityAttribute[] attributes=new DBSEntityAttribute[columnMappings.length];
  for (int i=0; i < rsAttributes.size(); i++) {
    columnMappings[i]=new ColumnMapping(rsAttributes.get(i));
    columnMappings[i].targetAttr=containerMapping.getAttributeMapping(columnMappings[i].rsAttr);
    if (columnMappings[i].targetAttr == null) {
      throw new DBCException("Can't find target attribute [" + columnMappings[i].rsAttr.getName() + "]");
    }
    columnMappings[i].valueHandler=DBUtils.findValueHandler(session,columnMappings[i].rsAttr);
    attributes[i]=columnMappings[i].targetAttr.getTarget();
  }
  executeBatch=containerMapping.getTarget().insertData(targetSession,attributes,null);
}
