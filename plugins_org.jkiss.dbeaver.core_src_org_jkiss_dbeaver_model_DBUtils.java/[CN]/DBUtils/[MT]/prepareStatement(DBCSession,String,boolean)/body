{
  DBCStatementType statementType=DBCStatementType.QUERY;
  query=SQLUtils.makeUnifiedLineFeeds(query);
  DBPDataSource dataSource=session.getDataSource();
  if (dataSource instanceof SQLDataSource) {
    final Collection<String> executeKeywords=((SQLDataSource)dataSource).getSQLDialect().getExecuteKeywords();
    if (!CommonUtils.isEmpty(executeKeywords)) {
      final String queryStart=SQLUtils.getFirstKeyword(query);
      for (      String keyword : executeKeywords) {
        if (keyword.equalsIgnoreCase(queryStart)) {
          statementType=DBCStatementType.EXEC;
          break;
        }
      }
    }
  }
  return session.prepareStatement(statementType,query,scrollable && dataSource.getInfo().supportsResultSetScroll(),false,false);
}
