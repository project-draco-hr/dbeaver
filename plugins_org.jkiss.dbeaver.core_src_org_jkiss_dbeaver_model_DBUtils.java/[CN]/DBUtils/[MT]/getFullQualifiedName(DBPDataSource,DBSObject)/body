{
  final DBPDataSourceInfo info=dataSource.getInfo();
  StringBuilder name=new StringBuilder();
  DBSObject parent=null;
  for (  DBSObject namePart : path) {
    if (namePart == null) {
      continue;
    }
    if (namePart instanceof DBSCatalog && ((info.getCatalogUsage() & DBPDataSourceInfo.USAGE_DML) == 0)) {
      continue;
    }
    if (namePart instanceof DBSSchema && ((info.getSchemaUsage() & DBPDataSourceInfo.USAGE_DML) == 0)) {
      continue;
    }
    if (!isValidObjectName(namePart.getName())) {
      continue;
    }
    if (name.length() > 0) {
      if (parent instanceof DBSCatalog) {
        if (!info.isCatalogAtStart()) {
          log.warn("Catalog name should be at the start of full-qualified name!");
        }
        name.append(info.getCatalogSeparator());
      }
 else {
        name.append(info.getStructSeparator());
      }
    }
    name.append(DBUtils.getQuotedIdentifier(dataSource,namePart.getName()));
    parent=namePart;
  }
  return name.toString();
}
