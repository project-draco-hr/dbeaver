{
switch (event.getAction()) {
case OBJECT_ADD:
    if (event.getObject() instanceof DataSourceDescriptor) {
      addDataSource((DataSourceDescriptor)event.getObject(),true);
    }
 else     if (DBNModel.getInstance().getNodeByObject(event.getObject()) == null) {
      final DBNDatabaseNode parentNode=DBNModel.getInstance().getParentNode(event.getObject());
      if (parentNode != null) {
        if (parentNode.getChildNodes() == null && parentNode.allowsChildren()) {
          try {
            DBeaverUI.runInProgressService(new DBRRunnableWithProgress(){
              @Override public void run(              DBRProgressMonitor monitor) throws InvocationTargetException, InterruptedException {
                try {
                  parentNode.getChildren(monitor);
                }
 catch (                Exception e) {
                  throw new InvocationTargetException(e);
                }
              }
            }
);
          }
 catch (          InvocationTargetException e) {
            log.error(e.getTargetException());
          }
catch (          InterruptedException e) {
          }
        }
        if (parentNode.getChildNodes() != null) {
          parentNode.addChildItem(event.getObject());
        }
      }
    }
  break;
case OBJECT_REMOVE:
if (event.getObject() instanceof DataSourceDescriptor) {
  removeDataSource((DataSourceDescriptor)event.getObject());
}
 else {
  final DBNDatabaseNode node=DBNModel.getInstance().getNodeByObject(event.getObject());
  if (node != null && node.getParentNode() instanceof DBNDatabaseNode) {
    ((DBNDatabaseNode)node.getParentNode()).removeChildItem(event.getObject());
  }
}
break;
case OBJECT_UPDATE:
case OBJECT_SELECT:
{
DBNNode dbmNode=DBNModel.getInstance().getNodeByObject(event.getObject());
if (dbmNode != null) {
DBNEvent.NodeChange nodeChange;
Boolean enabled=null;
if (event.getAction() == DBPEvent.Action.OBJECT_SELECT) {
  nodeChange=DBNEvent.NodeChange.REFRESH;
}
 else {
  enabled=event.getEnabled();
  if (enabled != null) {
    if (enabled) {
      nodeChange=DBNEvent.NodeChange.LOAD;
    }
 else {
      nodeChange=DBNEvent.NodeChange.UNLOAD;
    }
  }
 else {
    nodeChange=DBNEvent.NodeChange.REFRESH;
  }
}
DBNModel.getInstance().fireNodeUpdate(this,dbmNode,nodeChange);
if (enabled != null && !enabled) {
  dbmNode.clearNode(false);
}
}
break;
}
}
}
