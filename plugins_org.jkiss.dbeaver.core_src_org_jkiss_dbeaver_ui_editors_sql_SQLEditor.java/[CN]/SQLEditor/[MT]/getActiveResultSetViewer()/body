{
  if (resultTabs == null || resultTabs.isDisposed()) {
    return null;
  }
  CTabItem curTab=resultTabs.getSelection();
  if (curTab != null && !curTab.isDisposed() && curTab.getData() instanceof QueryResultsContainer) {
    return ((QueryResultsContainer)curTab.getData()).getResultSetViewer();
  }
  return curQueryProcessor == null ? null : curQueryProcessor.getCurrentResults().getResultSetViewer();
}
