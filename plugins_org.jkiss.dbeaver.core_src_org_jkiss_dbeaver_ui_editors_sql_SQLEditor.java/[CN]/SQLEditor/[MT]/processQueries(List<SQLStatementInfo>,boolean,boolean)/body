{
  if (queries.isEmpty()) {
    return;
  }
  try {
    checkSession();
  }
 catch (  DBException ex) {
    getResultSetViewer().setStatus(ex.getMessage(),true);
    UIUtils.showErrorDialog(getSite().getShell(),CoreMessages.editors_sql_error_cant_obtain_session,ex.getMessage());
    return;
  }
  if (export) {
    ActiveWizardDialog dialog=new ActiveWizardDialog(getSite().getWorkbenchWindow(),new DataTransferWizard(new IDataTransferProducer[]{new DatabaseTransferProducer(getDataContainer(),null)},null),new StructuredSelection(this));
    dialog.open();
    return;
  }
  final boolean isSingleQuery=(queries.size() == 1);
  if (newTab && !isSingleQuery) {
    closeExtraResultTabs();
  }
  if (newTab) {
    for (int i=0; i < queries.size(); i++) {
      SQLStatementInfo query=queries.get(i);
      DataContainer dataContainer=(i == 0 && !isSingleQuery ? curDataContainer : createDataContainer(queries.size() == 1));
      dataContainer.processQueries(Collections.singletonList(query),true);
    }
  }
 else {
    resultTabs.setSelection(curDataContainer.tabItem);
    curDataContainer.processQueries(queries,false);
  }
}
