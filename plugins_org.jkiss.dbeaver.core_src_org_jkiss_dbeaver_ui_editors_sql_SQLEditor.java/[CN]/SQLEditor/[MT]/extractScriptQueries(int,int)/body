{
  IDocument document=getDocument();
  SQLSyntaxManager syntaxManager=getSyntaxManager();
  List<SQLStatementInfo> queryList=new ArrayList<SQLStatementInfo>();
  syntaxManager.setRange(document,startOffset,length);
  int statementStart=startOffset;
  boolean hasValuableTokens=false;
  for (; ; ) {
    IToken token=syntaxManager.nextToken();
    if (token.isEOF() || token instanceof SQLDelimiterToken) {
      int tokenOffset=syntaxManager.getTokenOffset();
      if (tokenOffset >= document.getLength()) {
        tokenOffset=document.getLength();
      }
      try {
        while (statementStart < tokenOffset && Character.isWhitespace(document.getChar(statementStart))) {
          statementStart++;
        }
        if (hasValuableTokens) {
          int queryLength=tokenOffset - statementStart;
          String query=document.get(statementStart,queryLength);
          query=query.trim();
          if (query.length() > 0) {
            SQLStatementInfo statementInfo=new SQLStatementInfo(query);
            statementInfo.setOffset(statementStart);
            statementInfo.setLength(queryLength);
            queryList.add(statementInfo);
          }
        }
        hasValuableTokens=false;
      }
 catch (      BadLocationException ex) {
        log.error("Error extracting script query",ex);
      }
      statementStart=tokenOffset + 1;
    }
    if (token.isEOF()) {
      break;
    }
    if (!token.isWhitespace() && !(token instanceof SQLCommentToken)) {
      hasValuableTokens=true;
    }
  }
  for (  SQLStatementInfo statementInfo : queryList) {
    statementInfo.parseParameters(getDocument(),getSyntaxManager());
  }
  return queryList;
}
