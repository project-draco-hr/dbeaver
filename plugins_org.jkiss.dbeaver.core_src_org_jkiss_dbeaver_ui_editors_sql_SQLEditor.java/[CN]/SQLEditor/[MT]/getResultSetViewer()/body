{
  CTabItem curTab=resultTabs == null ? null : resultTabs.getSelection();
  if (curTab != null && !curTab.isDisposed()) {
    Object tabData=curTab.getData();
    if (tabData instanceof ResultSetViewer) {
      return (ResultSetViewer)tabData;
    }
  }
  return resultSetViewers.isEmpty() ? null : resultSetViewers.get(0);
}
