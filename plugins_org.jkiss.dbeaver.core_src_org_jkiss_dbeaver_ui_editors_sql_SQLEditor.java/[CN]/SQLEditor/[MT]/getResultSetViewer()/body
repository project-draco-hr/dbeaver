{
  if (resultTabs == null || resultTabs.isDisposed()) {
    return null;
  }
  CTabItem curTab=resultTabs.getSelection();
  if (curTab != null && curTab.getData() instanceof QueryResultsProvider) {
    return ((QueryResultsProvider)curTab.getData()).getResultSetViewer();
  }
  return curQueryProcessor == null ? null : curQueryProcessor.getFirstResults().getResultSetViewer();
}
