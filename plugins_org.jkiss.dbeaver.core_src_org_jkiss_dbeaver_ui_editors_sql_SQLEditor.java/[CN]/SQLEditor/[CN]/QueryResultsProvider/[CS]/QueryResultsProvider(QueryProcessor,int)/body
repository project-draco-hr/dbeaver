{
  this.queryProcessor=queryProcessor;
  this.resultSetNumber=resultSetNumber;
  viewer=new ResultSetViewer(resultTabs,getSite(),this);
  selectionProvider.trackProvider(viewer.getSpreadsheet(),viewer);
  viewer.getSpreadsheet().addFocusListener(new FocusAdapter(){
    @Override public void focusGained(    FocusEvent e){
      findReplaceTarget.setTarget(viewer.getFindReplaceTarget());
    }
  }
);
  int tabIndex=Math.max(resultTabs.getItemCount() - 2,0);
  int queryIndex=queryProcessors.indexOf(queryProcessor);
  tabItem=new CTabItem(resultTabs,SWT.NONE,tabIndex);
  String tabName=CoreMessages.editors_sql_data_grid;
  if (resultSetNumber > 0) {
    tabName+=" " + queryIndex + "/"+ (resultSetNumber + 1);
  }
 else   if (queryIndex > 0) {
    tabName+=" " + queryIndex;
  }
  tabItem.setText(tabName);
  tabItem.setImage(imgDataGrid);
  tabItem.setData(this);
  if (queryIndex > 0 || resultSetNumber > 0) {
    tabItem.setShowClose(true);
  }
  tabItem.setControl(viewer.getControl());
  tabItem.addDisposeListener(new DisposeListener(){
    @Override public void widgetDisposed(    DisposeEvent e){
      QueryResultsProvider.this.queryProcessor.removeResults(QueryResultsProvider.this);
    }
  }
);
}
