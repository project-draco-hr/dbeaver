{
  if (result.hasError()) {
    setStatus(result.getError().getMessage(),true);
  }
  if (!scriptMode) {
    getSelectionProvider().setSelection(originalSelection);
  }
  CTabItem tabItem=queryProcessor.getFirstResults().tabItem;
  if (!tabItem.isDisposed()) {
    tabItem.setToolTipText(result.getStatement().getQuery());
    if (!CommonUtils.isEmpty(result.getSourceEntity())) {
      tabItem.setText(result.getSourceEntity());
    }
 else {
      int tabIndex=getTabIndex(tabItem);
      tabItem.setText(CoreMessages.editors_sql_data_grid + (tabIndex == 0 ? "" : " [" + (tabIndex + 1) + "]"));
    }
  }
  if (result.getQueryTime() > DBeaverCore.getGlobalPreferenceStore().getLong(PrefConstants.AGENT_LONG_OPERATION_TIMEOUT) * 1000) {
    DBeaverUI.notifyAgent("Query completed [" + getEditorInput().getPath().lastSegment() + "]"+ ContentUtils.getDefaultLineSeparator()+ CommonUtils.truncateString(result.getStatement().getQuery(),200),!result.hasError() ? IStatus.INFO : IStatus.ERROR);
  }
}
