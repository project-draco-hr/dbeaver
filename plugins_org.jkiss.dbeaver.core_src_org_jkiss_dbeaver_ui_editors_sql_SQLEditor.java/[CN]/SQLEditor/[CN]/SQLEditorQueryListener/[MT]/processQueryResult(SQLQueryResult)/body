{
  if (result.hasError()) {
    setStatus(result.getError().getMessage(),true);
  }
  if (!scriptMode) {
    getSelectionProvider().setSelection(originalSelection);
  }
  QueryResultsProvider results=queryProcessor.getFirstResults();
  if (results != null) {
    CTabItem tabItem=results.tabItem;
    if (!tabItem.isDisposed()) {
      tabItem.setToolTipText(result.getStatement().getQuery());
      if (!CommonUtils.isEmpty(result.getSourceEntity())) {
        tabItem.setText(result.getSourceEntity());
      }
 else {
        int queryIndex=queryProcessors.indexOf(queryProcessor);
        tabItem.setText(CoreMessages.editors_sql_data_grid + (queryIndex == 0 ? "" : " " + (queryIndex + 1)));
      }
    }
  }
  if (result.getQueryTime() > DBeaverCore.getGlobalPreferenceStore().getLong(PrefConstants.AGENT_LONG_OPERATION_TIMEOUT) * 1000) {
    DBeaverUI.notifyAgent("Query completed [" + getEditorInput().getPath().lastSegment() + "]"+ ContentUtils.getDefaultLineSeparator()+ CommonUtils.truncateString(result.getStatement().getQuery(),200),!result.hasError() ? IStatus.INFO : IStatus.ERROR);
  }
}
