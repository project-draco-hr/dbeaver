{
  try {
    List<String> catalogs=dumpResultSetAndReturn("Catalogs",metaData.getCatalogs(),"TABLE_CAT");
    if (catalogs.isEmpty()) {
      catalogs.add("%");
    }
    for (    String catalog : catalogs) {
      List<String> schemas=dumpResultSetAndReturn(catalog + " Schemas",metaData.getSchemas(catalog,"%"),"TABLE_SCHEM");
      if (schemas.isEmpty() && catalogs.size() == 1) {
        catalog="%";
        schemas=dumpResultSetAndReturn("All Schemas",metaData.getSchemas("%","%"),"TABLE_SCHEM");
        if (schemas.isEmpty()) {
          schemas.add("%");
        }
      }
      final String catalogName=catalog;
      for (      final String schema : schemas) {
        dumpResultSet("Tables of " + catalog + "."+ schema,"",metaData.getTables(catalog,schema,"%",null),new NestedFetcher(){
          @Override public void readNestedInfo(          ResultSet resultSet) throws SQLException {
            String tableName=resultSet.getString("TABLE_NAME");
            System.out.println("\tColumns:");
            dumpResultSet(null,"\t\t",metaData.getColumns(catalogName,schema,tableName,"%"),null);
            System.out.println("\tIndexes:");
            dumpResultSet(null,"\t\t",metaData.getIndexInfo(catalogName,schema,tableName,false,false),null);
            System.out.println("\tImported Keys:");
            dumpResultSet(null,"\t\t",metaData.getImportedKeys(catalogName,schema,tableName),null);
            System.out.println("\tExported Keys:");
            dumpResultSet(null,"\t\t",metaData.getExportedKeys(catalogName,schema,tableName),null);
          }
        }
);
      }
    }
  }
 catch (  SQLException e) {
    e.printStackTrace();
  }
}
