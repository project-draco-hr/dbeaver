{
  IResourceDelta delta=event.getDelta();
  if (delta == null) {
    return;
  }
  for (  IResourceDelta projectDelta : delta.getAffectedChildren()) {
    if (projectDelta.getResource() instanceof IProject) {
      IProject project=(IProject)projectDelta.getResource();
      if (projectDelta.getKind() == IResourceDelta.REMOVED) {
        if (project == activeProject) {
          setActiveProject(null);
        }
        GlobalPropertyTester.firePropertyChange(GlobalPropertyTester.PROP_HAS_MULTI_PROJECTS);
      }
 else       if (projectDelta.getKind() == IResourceDelta.ADDED) {
        if (activeProject == null) {
          setActiveProject(project);
        }
        GlobalPropertyTester.firePropertyChange(GlobalPropertyTester.PROP_HAS_MULTI_PROJECTS);
      }
    }
  }
}
