{
  if (resource == null || resource.isHidden() || resource.isPhantom()) {
    return null;
  }
  if (resource.getParent() instanceof IProject && resource.getName().equals(DataSourceRegistry.CONFIG_FILE_NAME)) {
    return null;
  }
  DBPResourceHandler handler=null;
  for (  ResourceHandlerDescriptor rhd : handlerDescriptors) {
    if (rhd.canHandle(resource)) {
      handler=rhd.getHandler();
      break;
    }
  }
  if (handler == null && resource instanceof IFolder) {
    IPath relativePath=resource.getFullPath().makeRelativeTo(resource.getProject().getFullPath());
    ResourceHandlerDescriptor handlerDescriptor=rootMapping.get(relativePath.toString());
    if (handlerDescriptor != null) {
      handler=handlerDescriptor.getHandler();
    }
  }
  if (handler == null) {
    handler=DefaultResourceHandlerImpl.INSTANCE;
  }
  return handler;
}
