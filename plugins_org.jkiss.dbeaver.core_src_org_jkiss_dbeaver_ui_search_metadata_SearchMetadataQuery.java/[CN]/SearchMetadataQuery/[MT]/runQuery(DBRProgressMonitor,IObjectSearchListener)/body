{
  listener.searchStarted();
  try {
    List<DBSObjectType> objectTypes=params.getObjectTypes();
    String objectNameMask=params.getObjectNameMask();
    if (params.getMatchType() == SearchMetadataConstants.MATCH_INDEX_STARTS_WITH) {
      if (!objectNameMask.endsWith("%")) {
        objectNameMask=objectNameMask + "%";
      }
    }
 else     if (params.getMatchType() == SearchMetadataConstants.MATCH_INDEX_CONTAINS) {
      if (!objectNameMask.startsWith("%")) {
        objectNameMask="%" + objectNameMask;
      }
      if (!objectNameMask.endsWith("%")) {
        objectNameMask=objectNameMask + "%";
      }
    }
    DBNModel navigatorModel=DBeaverCore.getInstance().getNavigatorModel();
    Collection<DBSObjectReference> objects=structureAssistant.findObjectsByMask(monitor,params.getParentObject(),objectTypes.toArray(new DBSObjectType[objectTypes.size()]),objectNameMask,params.isCaseSensitive(),params.getMaxResults());
    List<DBNNode> nodes=new ArrayList<DBNNode>();
    for (    DBSObjectReference reference : objects) {
      if (monitor.isCanceled()) {
        break;
      }
      try {
        DBSObject object=reference.resolveObject(monitor);
        if (object != null) {
          DBNNode node=navigatorModel.getNodeByObject(monitor,object,true);
          if (node != null) {
            nodes.add(node);
          }
        }
      }
 catch (      DBException e) {
        log.error(e);
      }
    }
    if (!nodes.isEmpty()) {
      listener.objectsFound(monitor,nodes);
    }
  }
  finally {
    listener.searchFinished();
  }
}
