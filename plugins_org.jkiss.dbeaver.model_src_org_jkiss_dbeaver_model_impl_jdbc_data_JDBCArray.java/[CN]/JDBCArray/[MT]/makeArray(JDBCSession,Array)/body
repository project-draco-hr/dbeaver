{
  if (array == null) {
    return null;
  }
  DBSDataType type=null;
  if (session.getDataSource() instanceof DBPDataTypeProvider) {
    try {
      String baseTypeName=array.getBaseTypeName();
      type=session.getDataSource().resolveDataType(session.getProgressMonitor(),baseTypeName);
    }
 catch (    Exception e) {
      log.warn("Error resolving data type",e);
    }
  }
  try {
    if (type == null) {
      try {
        return extractDataFromResultSet(session,array,null,null);
      }
 catch (      SQLException e) {
        throw new DBCException(e,session.getDataSource());
      }
    }
    DBDValueHandler valueHandler=DBUtils.findValueHandler(session,type);
    try {
      return extractDataFromArray(session,array,type,valueHandler);
    }
 catch (    SQLException e) {
      try {
        return extractDataFromResultSet(session,array,type,valueHandler);
      }
 catch (      SQLException e1) {
        throw new DBCException(e1,session.getDataSource());
      }
    }
  }
 catch (  DBException e) {
    log.warn("Can't extract array data from JDBC array",e);
    return null;
  }
}
