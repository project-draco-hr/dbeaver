{
  if (!(part instanceof IEditorPart)) {
    if (part == null || part.getSite() == null || part.getSite().getPage() == null) {
      part=null;
    }
 else {
      part=part.getSite().getPage().getActiveEditor();
    }
  }
  if (activePart != part || activePart == null) {
    DBPDataSourceContainer container=getDataSourceContainer(activePart);
    if (container == getDataSourceContainer(part)) {
      return;
    }
    if (container != null) {
      container.getPreferenceStore().removePropertyChangeListener(this);
    }
    activePart=part;
    container=getDataSourceContainer();
    if (container != null) {
      container.getPreferenceStore().addPropertyChangeListener(this);
    }
    updateControls(true);
  }
  UIUtils.updateMainWindowTitle(workbenchWindow);
}
