{
  if (!(part instanceof IEditorPart)) {
    if (part == null || part.getSite() == null || part.getSite().getPage() == null) {
      part=null;
    }
 else {
      part=part.getSite().getPage().getActiveEditor();
    }
  }
  if (activePart != part || activePart == null) {
    DBPDataSourceContainer oldContainer=getDataSourceContainer(activePart);
    DBPDataSourceContainer newContainer=getDataSourceContainer(part);
    activePart=part;
    if (oldContainer == newContainer) {
      return;
    }
    if (oldContainer != null) {
      oldContainer.getPreferenceStore().removePropertyChangeListener(this);
    }
    oldContainer=getDataSourceContainer();
    if (oldContainer != null) {
      oldContainer.getPreferenceStore().addPropertyChangeListener(this);
    }
    updateControls(true);
  }
  UIUtils.updateMainWindowTitle(workbenchWindow);
}
