{
  DBSEntityAttribute attribute=null;
  if (type instanceof DBSTableColumn) {
    attribute=(DBSTableColumn)type;
  }
 else   if (type instanceof DBCAttributeMetaData) {
    try {
      attribute=((DBCAttributeMetaData)type).getAttribute(session.getProgressMonitor());
    }
 catch (    DBException e) {
      throw new SQLException(e);
    }
  }
  if (attribute == null) {
    throw new SQLException("Could not find table column for column '" + index + "'");
  }
  MSSQLTableColumn enumColumn;
  if (attribute instanceof MSSQLTableColumn) {
    enumColumn=(MSSQLTableColumn)attribute;
  }
 else {
    throw new SQLException("Bad column type: " + attribute.getClass().getName());
  }
  return new MSSQLTypeEnum(enumColumn,resultSet.getString(index));
}
