{
  Object value=resultSet.getObject(columnIndex);
  String typeName;
  if (value instanceof Struct) {
    typeName=((Struct)value).getSQLTypeName();
  }
 else {
    typeName=column.getTypeName();
  }
  DBSDataType dataType=null;
  try {
    dataType=DBUtils.resolveDataType(context.getProgressMonitor(),context.getDataSource(),typeName);
  }
 catch (  DBException e) {
    log.error("Error resolving data type '" + typeName + "'",e);
  }
  if (value == null) {
    return new JDBCStruct(dataType,null);
  }
 else   if (value instanceof Struct) {
    return new JDBCStruct(dataType,(Struct)value);
  }
 else {
    throw new DBCException("Unsupported struct type: " + value.getClass().getName());
  }
}
