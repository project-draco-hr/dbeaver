{
  if (element.getServiceLocator() instanceof IWorkbenchPartSite) {
    IWorkbenchPartSite partSite=(IWorkbenchPartSite)element.getServiceLocator();
    if (partSite.getPart() instanceof IResultSetContainer) {
      ResultSetViewer rsv=((IResultSetContainer)partSite.getPart()).getResultSetViewer();
      if (rsv != null) {
        IResultSetPresentation presentation=rsv.getActivePresentation();
        if (presentation instanceof SpreadsheetPresentation && ((SpreadsheetPresentation)presentation).isPreviewVisible()) {
          element.setText("Hide value view panel");
          element.setChecked(true);
        }
 else {
          element.setText("Show value view panel");
          element.setChecked(false);
        }
      }
    }
  }
}
