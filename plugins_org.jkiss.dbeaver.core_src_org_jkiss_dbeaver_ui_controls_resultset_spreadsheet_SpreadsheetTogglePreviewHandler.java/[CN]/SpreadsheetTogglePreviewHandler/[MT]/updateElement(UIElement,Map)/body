{
  if (element.getServiceLocator() instanceof IWorkbenchPartSite) {
    IWorkbenchPartSite partSite=(IWorkbenchPartSite)element.getServiceLocator();
    ResultSetViewer rsv=ResultSetCommandHandler.getActiveResultSet(partSite.getPart());
    if (rsv != null) {
      IResultSetPresentation presentation=rsv.getActivePresentation();
      if (presentation instanceof SpreadsheetPresentation && ((SpreadsheetPresentation)presentation).isPreviewVisible()) {
        element.setText("Hide value view panel");
        element.setChecked(true);
      }
 else {
        element.setText("Show value view panel");
        element.setChecked(false);
      }
    }
  }
}
