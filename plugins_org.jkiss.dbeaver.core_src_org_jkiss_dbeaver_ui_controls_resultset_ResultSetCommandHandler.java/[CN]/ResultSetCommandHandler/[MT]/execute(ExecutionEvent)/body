{
  ResultSetViewer resultSet=getActiveResultSet(HandlerUtil.getActivePart(event));
  if (resultSet == null) {
    return null;
  }
  String actionId=event.getCommand().getId();
  IResultSetPresentation presentation=resultSet.getActivePresentation();
  if (actionId.equals(IWorkbenchCommandConstants.FILE_REFRESH)) {
    resultSet.refresh();
  }
 else   if (actionId.equals(CMD_TOGGLE_MODE)) {
    resultSet.toggleMode();
  }
 else   if (actionId.equals(CMD_ROW_PREVIOUS) || actionId.equals(ITextEditorActionDefinitionIds.WORD_PREVIOUS)) {
    presentation.scrollToRow(IResultSetPresentation.RowPosition.PREVIOUS);
  }
 else   if (actionId.equals(CMD_ROW_NEXT) || actionId.equals(ITextEditorActionDefinitionIds.WORD_NEXT)) {
    presentation.scrollToRow(IResultSetPresentation.RowPosition.NEXT);
  }
 else   if (actionId.equals(CMD_ROW_FIRST) || actionId.equals(ITextEditorActionDefinitionIds.SELECT_WORD_PREVIOUS)) {
    presentation.scrollToRow(IResultSetPresentation.RowPosition.FIRST);
  }
 else   if (actionId.equals(CMD_ROW_LAST) || actionId.equals(ITextEditorActionDefinitionIds.SELECT_WORD_NEXT)) {
    presentation.scrollToRow(IResultSetPresentation.RowPosition.LAST);
  }
 else   if (actionId.equals(CMD_ROW_EDIT)) {
    if (presentation instanceof IResultSetEditor) {
      ((IResultSetEditor)presentation).openValueEditor(false);
    }
  }
 else   if (actionId.equals(CMD_ROW_EDIT_INLINE)) {
    if (presentation instanceof IResultSetEditor) {
      ((IResultSetEditor)presentation).openValueEditor(true);
    }
  }
 else   if (actionId.equals(CMD_ROW_ADD)) {
    resultSet.addNewRow(false);
  }
 else   if (actionId.equals(CMD_ROW_COPY)) {
    resultSet.addNewRow(true);
  }
 else   if (actionId.equals(CMD_ROW_DELETE) || actionId.equals(IWorkbenchCommandConstants.EDIT_DELETE)) {
    resultSet.deleteSelectedRows();
  }
 else   if (actionId.equals(CMD_APPLY_CHANGES)) {
    resultSet.applyChanges(null);
  }
 else   if (actionId.equals(CMD_REJECT_CHANGES)) {
    resultSet.rejectChanges();
  }
 else   if (actionId.equals(IWorkbenchCommandConstants.EDIT_COPY)) {
    ResultSetUtils.copyToClipboard(presentation.copySelectionToString(false,false,false,null,DBDDisplayFormat.EDIT));
  }
 else   if (actionId.equals(IWorkbenchCommandConstants.EDIT_PASTE)) {
    if (presentation instanceof IResultSetEditor) {
      ((IResultSetEditor)presentation).pasteFromClipboard();
    }
  }
 else   if (actionId.equals(IWorkbenchCommandConstants.EDIT_CUT)) {
    ResultSetUtils.copyToClipboard(presentation.copySelectionToString(false,false,true,null,DBDDisplayFormat.EDIT));
  }
 else   if (actionId.equals(ITextEditorActionDefinitionIds.SMART_ENTER)) {
    if (presentation instanceof IResultSetEditor) {
      ((IResultSetEditor)presentation).openValueEditor(false);
    }
  }
  return null;
}
