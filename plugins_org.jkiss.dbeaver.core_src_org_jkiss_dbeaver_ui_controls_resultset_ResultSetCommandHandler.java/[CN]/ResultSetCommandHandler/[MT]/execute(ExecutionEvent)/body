{
  Spreadsheet spreadsheet=getActiveSpreadsheet(event);
  if (spreadsheet == null) {
    return null;
  }
  if (!(spreadsheet.getController() instanceof ResultSetViewer)) {
    return null;
  }
  ResultSetViewer resultSet=(ResultSetViewer)spreadsheet.getController();
  String actionId=event.getCommand().getId();
  if (actionId.equals(IWorkbenchCommandConstants.FILE_REFRESH)) {
    resultSet.refresh();
  }
 else   if (actionId.equals(CMD_TOGGLE_MODE)) {
    resultSet.toggleMode();
  }
 else   if (actionId.equals(CMD_ROW_PREVIOUS) || actionId.equals(ITextEditorActionDefinitionIds.WORD_PREVIOUS)) {
    resultSet.scrollToRow(ResultSetViewer.RowPosition.PREVIOUS);
  }
 else   if (actionId.equals(CMD_ROW_NEXT) || actionId.equals(ITextEditorActionDefinitionIds.WORD_NEXT)) {
    resultSet.scrollToRow(ResultSetViewer.RowPosition.NEXT);
  }
 else   if (actionId.equals(CMD_ROW_FIRST) || actionId.equals(ITextEditorActionDefinitionIds.SELECT_WORD_PREVIOUS)) {
    resultSet.scrollToRow(ResultSetViewer.RowPosition.FIRST);
  }
 else   if (actionId.equals(CMD_ROW_LAST) || actionId.equals(ITextEditorActionDefinitionIds.SELECT_WORD_NEXT)) {
    resultSet.scrollToRow(ResultSetViewer.RowPosition.LAST);
  }
 else   if (actionId.equals(CMD_ROW_EDIT)) {
    resultSet.getSpreadsheet().openCellViewer(false);
  }
 else   if (actionId.equals(CMD_ROW_EDIT_INLINE)) {
    resultSet.getSpreadsheet().openCellViewer(true);
  }
 else   if (actionId.equals(CMD_ROW_ADD)) {
    resultSet.addNewRow(false);
  }
 else   if (actionId.equals(CMD_ROW_COPY)) {
    resultSet.addNewRow(true);
  }
 else   if (actionId.equals(CMD_ROW_DELETE) || actionId.equals(IWorkbenchCommandConstants.EDIT_DELETE)) {
    resultSet.deleteSelectedRows();
  }
 else   if (actionId.equals(CMD_APPLY_CHANGES)) {
    resultSet.applyChanges(null);
  }
 else   if (actionId.equals(CMD_REJECT_CHANGES)) {
    resultSet.rejectChanges();
  }
 else   if (actionId.equals(IWorkbenchCommandConstants.EDIT_PASTE)) {
    resultSet.pasteCellValue();
  }
 else   if (actionId.equals(IWorkbenchCommandConstants.EDIT_CUT)) {
    resultSet.getSpreadsheet().copySelectionToClipboard(false);
  }
  return null;
}
