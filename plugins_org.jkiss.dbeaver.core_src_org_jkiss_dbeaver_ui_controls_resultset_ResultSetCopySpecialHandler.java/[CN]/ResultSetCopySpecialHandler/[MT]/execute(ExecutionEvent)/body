{
  IResultSetController resultSet=getActiveResultSet(HandlerUtil.getActivePart(event));
  if (resultSet == null) {
    return null;
  }
  if (event.getCommand().getId().equals(CoreCommands.CMD_COPY_SPECIAL)) {
    ConfigDialog configDialog=new ConfigDialog(HandlerUtil.getActiveShell(event));
    if (configDialog.open() == IDialogConstants.OK_ID) {
      ResultSetUtils.copyToClipboard(resultSet.getActivePresentation().copySelectionToString(configDialog.copyHeader,configDialog.copyRows,false,configDialog.delimiter,configDialog.format));
    }
  }
  return null;
}
