{
  Object cellValue=getCellValue(element,columnIndex);
  if (cellValue != null) {
    GC gc=event.gc;
    if (isHyperlink(cellValue)) {
      boolean isSelected=gc.getBackground().equals(selectionBackgroundColor);
      prepareLinkStyle(cellValue,isSelected ? gc.getForeground() : null);
      Rectangle textBounds;
      if (event.item instanceof TreeItem) {
        textBounds=((TreeItem)event.item).getTextBounds(event.index);
      }
 else {
        textBounds=((TableItem)event.item).getTextBounds(event.index);
      }
      linkLayout.draw(gc,textBounds.x,textBounds.y + 1);
    }
  }
}
