{
  try {
    File cacheDir=getLocalCacheDir();
    if (!cacheDir.exists()) {
      if (!cacheDir.mkdirs()) {
        throw new IOException("Can't create cache directory '" + cacheDir.getAbsolutePath() + "'");
      }
    }
    File cacheFile=new File(cacheDir,METADATA_CACHE_FILE);
    OutputStream out=new FileOutputStream(cacheFile);
    try {
      XMLBuilder xml=new XMLBuilder(out,"utf-8");
      xml.setButify(true);
      try (XMLBuilder.Element e=xml.startElement(TAG_CACHE)){
        xml.addAttribute(ATTR_NAME,name);
        xml.addAttribute(ATTR_URL,url);
        for (        MavenArtifact artifact : cachedArtifacts.values()) {
          if (CommonUtils.isEmpty(artifact.getLocalVersions())) {
            continue;
          }
          MavenArtifactVersion activeVersion=artifact.getActiveVersion();
          if (activeVersion != null) {
            try (XMLBuilder.Element e1=xml.startElement(TAG_ARTIFACT)){
              xml.addAttribute(ATTR_GROUP_ID,artifact.getGroupId());
              xml.addAttribute(ATTR_ARTIFACT_ID,artifact.getArtifactId());
              xml.addAttribute(ATTR_ACTIVE_VERSION,activeVersion.getVersion());
            }
           }
        }
      }
       xml.flush();
    }
  finally {
      IOUtils.close(out);
    }
  }
 catch (  IOException e) {
    log.warn("Error saving local Maven cache",e);
  }
}
