{
  DatabaseNavigatorTree navigatorTree=new DatabaseNavigatorTree(parent,rootNode,getTreeStyle());
  navigatorTree.getViewer().addSelectionChangedListener(new ISelectionChangedListener(){
    @Override public void selectionChanged(    SelectionChangedEvent event){
      IStructuredSelection structSel=(IStructuredSelection)event.getSelection();
      if (!structSel.isEmpty()) {
        lastSelection=structSel.getFirstElement();
        if (lastSelection instanceof DBNNode) {
          String desc=((DBNNode)lastSelection).getNodeDescription();
          if (CommonUtils.isEmpty(desc)) {
            desc=((DBNNode)lastSelection).getNodeName();
          }
          getViewSite().getActionBars().getStatusLineManager().setMessage(desc);
        }
      }
 else {
        lastSelection=null;
      }
    }
  }
);
  navigatorTree.getViewer().addDoubleClickListener(new IDoubleClickListener(){
    @Override public void doubleClick(    DoubleClickEvent event){
      TreeViewer viewer=tree.getViewer();
      IStructuredSelection selection=(IStructuredSelection)viewer.getSelection();
      if (selection.size() == 1) {
        DBNNode node=(DBNNode)selection.getFirstElement();
        if (node instanceof DBNResource) {
          if (((DBNResource)node).getResource() instanceof IFolder) {
            if (Boolean.TRUE.equals(viewer.getExpandedState(node))) {
              viewer.collapseToLevel(node,1);
            }
 else {
              viewer.expandToLevel(node,1);
            }
          }
 else {
            NavigatorHandlerObjectOpen.openResource(((DBNResource)node).getResource(),getSite().getWorkbenchWindow());
          }
        }
 else         if (node instanceof DBNDatabaseNode && node.allowsOpen()) {
          NavigatorHandlerObjectOpen.openEntityEditor((DBNDatabaseNode)node,null,getSite().getWorkbenchWindow());
        }
 else         if (node instanceof DBNLocalFolder) {
          if (viewer.getExpandedState(node)) {
            viewer.collapseToLevel(selection.getFirstElement(),1);
          }
 else {
            viewer.expandToLevel(selection.getFirstElement(),1);
          }
        }
      }
    }
  }
);
  NavigatorUtils.addContextMenu(this.getSite(),navigatorTree.getViewer(),navigatorTree.getViewer().getControl());
  NavigatorUtils.addDragAndDropSupport(navigatorTree.getViewer());
  return navigatorTree;
}
