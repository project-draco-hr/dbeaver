{
  DBPObject rsSource=resultSetMeta.getResultSet().getSource();
  DBSObject dataContainer=rsSource instanceof DBCStatement ? ((DBCStatement)rsSource).getDataContainer() : null;
  DBSEntity ownerEntity=null;
  if (dataContainer instanceof DBSEntity) {
    ownerEntity=(DBSEntity)dataContainer;
  }
  this.index=index;
  this.label=resultSetMeta.getColumnLabel(index);
  this.name=resultSetMeta.getColumnName(index);
  this.readOnly=resultSetMeta.isReadOnly(index);
  this.writable=resultSetMeta.isWritable(index);
  String fetchedTableName=null;
  try {
    fetchedTableName=resultSetMeta.getTableName(index);
  }
 catch (  SQLException e) {
    log.debug(e);
  }
  String fetchedCatalogName=null;
  try {
    fetchedCatalogName=resultSetMeta.getCatalogName(index);
  }
 catch (  SQLException e) {
    log.debug(e);
  }
  String fetchedSchemaName=null;
  try {
    fetchedSchemaName=resultSetMeta.getSchemaName(index);
  }
 catch (  SQLException e) {
    log.debug(e);
  }
  if (!CommonUtils.isEmpty(fetchedTableName) && CommonUtils.isEmpty(fetchedCatalogName) && CommonUtils.isEmpty(fetchedSchemaName)) {
    final DBPDataSource dataSource=resultSetMeta.getResultSet().getSession().getDataSource();
    final DBPDataSourceInfo dsInfo=dataSource.getInfo();
    if (!DBUtils.isQuotedIdentifier(dataSource,fetchedTableName)) {
      final String catalogSeparator=dsInfo.getCatalogSeparator();
      final int catDivPos=fetchedTableName.indexOf(catalogSeparator);
      if (catDivPos != -1 && (dsInfo.getCatalogUsage() & DBPDataSourceInfo.USAGE_DML) != 0) {
        fetchedCatalogName=fetchedTableName.substring(0,catDivPos);
        fetchedTableName=fetchedTableName.substring(catDivPos + catalogSeparator.length());
      }
      final char structSeparator=dsInfo.getStructSeparator();
      final int schemaDivPos=fetchedTableName.indexOf(structSeparator);
      if (schemaDivPos != -1 && (dsInfo.getSchemaUsage() & DBPDataSourceInfo.USAGE_DML) != 0) {
        fetchedSchemaName=fetchedTableName.substring(0,schemaDivPos);
        fetchedTableName=fetchedTableName.substring(schemaDivPos + 1);
      }
    }
  }
  if (ownerEntity != null) {
    this.tableName=ownerEntity.getName();
    try {
      this.tableColumn=ownerEntity.getAttribute(resultSetMeta.getResultSet().getSession().getProgressMonitor(),name);
    }
 catch (    DBException e) {
      log.warn(e);
    }
    try {
      this.tableMetaData=resultSetMeta.getTableMetaData(ownerEntity);
    }
 catch (    DBException e) {
      log.warn(e);
    }
  }
 else {
    this.tableName=fetchedTableName;
  }
  if (this.tableColumn == null) {
    this.notNull=resultSetMeta.isNullable(index) == ResultSetMetaData.columnNoNulls;
    try {
      this.displaySize=resultSetMeta.getColumnDisplaySize(index);
    }
 catch (    SQLException e) {
      this.displaySize=0;
    }
    this.typeID=resultSetMeta.getColumnType(index);
    this.typeName=resultSetMeta.getColumnTypeName(index);
    this.sequence=resultSetMeta.isAutoIncrement(index);
    try {
      this.precision=resultSetMeta.getPrecision(index);
    }
 catch (    Exception e) {
      this.precision=0;
    }
    try {
      this.scale=resultSetMeta.getScale(index);
    }
 catch (    Exception e) {
      this.scale=0;
    }
  }
  if (this.tableMetaData == null) {
    try {
      if (!CommonUtils.isEmpty(this.tableName)) {
        this.tableMetaData=resultSetMeta.getTableMetaData(fetchedCatalogName,fetchedSchemaName,tableName);
      }
    }
 catch (    DBException e) {
      log.warn(e);
    }
  }
  if (this.tableMetaData != null) {
    this.tableMetaData.addAttribute(this);
  }
  dataKind=JDBCUtils.resolveDataKind(resultSetMeta.getResultSet().getSource().getSession().getDataSource(),typeName,typeID);
}
