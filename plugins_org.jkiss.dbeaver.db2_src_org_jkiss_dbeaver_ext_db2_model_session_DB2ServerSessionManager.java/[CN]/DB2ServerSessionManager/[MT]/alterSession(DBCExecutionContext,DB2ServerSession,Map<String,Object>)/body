{
  final boolean toKill=Boolean.TRUE.equals(options.get(PROP_KILL_SESSION));
  final boolean immediate=Boolean.TRUE.equals(options.get(PROP_IMMEDIATE));
  try {
    StringBuilder sql=new StringBuilder("ALTER SYSTEM ");
    if (toKill) {
      sql.append("KILL SESSION ");
    }
 else {
      sql.append("DISCONNECT SESSION ");
    }
    sql.append("'").append(session.getSid()).append(',').append(session.getSerial()).append("'");
    if (immediate) {
      sql.append(" IMMEDIATE");
    }
 else     if (!toKill) {
      sql.append(" POST_TRANSACTION");
    }
    JDBCPreparedStatement dbStat=((JDBCExecutionContext)context).prepareStatement(sql.toString());
    try {
      dbStat.execute();
    }
  finally {
      dbStat.close();
    }
  }
 catch (  SQLException e) {
    throw new DBException(e);
  }
}
