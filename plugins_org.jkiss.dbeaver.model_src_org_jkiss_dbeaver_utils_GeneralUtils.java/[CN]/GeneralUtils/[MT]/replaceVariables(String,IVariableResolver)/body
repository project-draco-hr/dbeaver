{
  Matcher matcher=VAR_PATTERN.matcher(string);
  int pos=0;
  while (matcher.find(pos)) {
    pos=matcher.end();
    String varName=matcher.group(2);
    String varValue=resolver.get(varName);
    if (varValue != null) {
      matcher=VAR_PATTERN.matcher(string=matcher.replaceFirst(varValue));
      pos=0;
    }
  }
  return string;
}
