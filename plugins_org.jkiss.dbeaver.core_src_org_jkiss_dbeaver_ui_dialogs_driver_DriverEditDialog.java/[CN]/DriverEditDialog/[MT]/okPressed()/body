{
  driver.setName(driverNameText.getText());
  driver.setCategory(driverCategoryCombo.getText());
  driver.setDescription(CommonUtils.notEmpty(driverDescText.getText()));
  driver.setDriverClassName(driverClassText.getText());
  driver.setSampleURL(driverURLText.getText());
  driver.setDriverDefaultPort(driverPortText.getText());
  driver.setEmbedded(embeddedDriverCheck.getSelection());
  driver.setModified(true);
  for (  DriverFileDescriptor lib : CommonUtils.safeCollection(libList)) {
    driver.addDriverFile(lib);
  }
  for (  DriverFileDescriptor lib : CommonUtils.copyList(driver.getDriverFiles())) {
    if (!libList.contains(lib)) {
      driver.removeDriverFile(lib);
    }
  }
  driver.setDriverParameters(driverPropertySource.getProperties());
  driver.setConnectionProperties(connectionPropertySource.getProperties());
  if (clientHomesPanel != null) {
    driver.setClientHomeIds(clientHomesPanel.getHomeIds());
  }
  if (provider.getDriver(driver.getId()) == null) {
    provider.addDriver(driver);
  }
  provider.getRegistry().saveDrivers();
  try {
    driver.loadDriver(DBeaverUI.getDefaultRunnableContext(),true,true);
  }
 catch (  Throwable ex) {
    UIUtils.showErrorDialog(getShell(),CoreMessages.dialog_edit_driver_dialog_driver_error_title,CoreMessages.dialog_edit_driver_dialog_driver_error_message,ex);
  }
  super.okPressed();
}
