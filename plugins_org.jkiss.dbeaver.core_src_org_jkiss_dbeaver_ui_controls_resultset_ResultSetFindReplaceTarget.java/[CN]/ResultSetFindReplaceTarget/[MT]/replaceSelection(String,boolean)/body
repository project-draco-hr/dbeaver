{
  GridPos selection=resultSet.getSelection().getFirstElement();
  if (selection == null) {
    return;
  }
  GridCell cell=resultSet.getSpreadsheet().posToCell(selection);
  if (cell == null) {
    return;
  }
  String oldValue=resultSet.getSpreadsheet().getContentProvider().getCellText(cell);
  String newValue=text;
  if (searchPattern != null) {
    newValue=searchPattern.matcher(oldValue).replaceAll(newValue);
  }
  cell=resultSet.translateVisualPos(cell);
  resultSet.getModel().updateCellValue((RowData)cell.row,(DBDAttributeBinding)cell.col,newValue);
  resultSet.updateEditControls();
  resultSet.getSpreadsheet().redrawGrid();
  resultSet.previewValue();
}
