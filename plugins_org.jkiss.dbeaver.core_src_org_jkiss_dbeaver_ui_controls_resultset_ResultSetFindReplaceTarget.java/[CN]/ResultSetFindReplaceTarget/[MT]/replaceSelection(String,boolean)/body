{
  GridPos selection=resultSet.getSelection().getFirstElement();
  if (selection == null) {
    return;
  }
  GridCell cell=resultSet.getSpreadsheet().posToCell(selection);
  if (cell == null) {
    return;
  }
  String oldValue=resultSet.getSpreadsheet().getContentProvider().getCellText(cell.col,cell.row);
  String newValue=text;
  if (searchPattern != null) {
    newValue=searchPattern.matcher(oldValue).replaceAll(newValue);
  }
  final DBDAttributeBinding attr=(DBDAttributeBinding)(resultSet.isRecordMode() ? cell.row : cell.col);
  final RowData row=(RowData)(resultSet.isRecordMode() ? cell.col : cell.row);
  resultSet.getModel().updateCellValue(attr,row,newValue);
  resultSet.updateEditControls();
  resultSet.getSpreadsheet().redrawGrid();
  resultSet.previewValue();
}
