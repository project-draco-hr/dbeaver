{
  try {
    formatterProfile.setProfileName(profileName);
    formatterProfile.setLocale(profileLocale);
    for (    String typeId : profileProperties.keySet()) {
      formatterProfile.setFormatterProperties(typeId,profileProperties.get(typeId));
    }
    formatterProfile.saveProfile();
  }
 catch (  Exception e) {
    log.warn(e);
  }
  if (formatterProfile == DataFormatterRegistry.getInstance().getGlobalProfile()) {
    for (    DBDDataFormatterProfile profile : DataFormatterRegistry.getInstance().getCustomProfiles()) {
      profile.reset();
    }
    for (    IProject project : DBeaverCore.getInstance().getLiveProjects()) {
      if (project.isOpen()) {
        DataSourceRegistry dsRegistry=DBeaverCore.getInstance().getProjectRegistry().getDataSourceRegistry(project);
        for (        DataSourceDescriptor ds : dsRegistry.getDataSources()) {
          ds.getDataFormatterProfile().reset();
        }
      }
    }
  }
}
