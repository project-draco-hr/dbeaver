{
  spreadsheet.cancelInlineEditor();
  if (resultsSash.getMaximizedControl() == null) {
    resultsSash.setMaximizedControl(spreadsheet);
  }
 else {
    resultsSash.setMaximizedControl(null);
    previewValue();
    spreadsheet.updateScrollbars();
    if (curAttribute != null) {
      spreadsheet.showColumn(curAttribute);
    }
  }
  DBeaverCore.getGlobalPreferenceStore().setValue(VIEW_PANEL_VISIBLE,isPreviewVisible());
  ICommandService commandService=controller.getSite().getService(ICommandService.class);
  if (commandService != null) {
    commandService.refreshElements(SpreadsheetCommandHandler.CMD_TOGGLE_PREVIEW,null);
  }
}
