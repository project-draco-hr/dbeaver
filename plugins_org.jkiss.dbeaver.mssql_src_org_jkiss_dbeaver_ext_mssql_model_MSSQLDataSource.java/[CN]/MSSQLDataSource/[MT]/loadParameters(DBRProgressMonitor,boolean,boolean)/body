{
  JDBCSession session=openSession(monitor,DBCExecutionPurpose.META,"Load status");
  try {
    JDBCPreparedStatement dbStat=session.prepareStatement("SHOW " + (global ? "GLOBAL " : "") + (status ? "STATUS" : "VARIABLES"));
    try {
      JDBCResultSet dbResult=dbStat.executeQuery();
      try {
        List<MSSQLParameter> parameters=new ArrayList<MSSQLParameter>();
        while (dbResult.next()) {
          MSSQLParameter parameter=new MSSQLParameter(this,JDBCUtils.safeGetString(dbResult,"variable_name"),JDBCUtils.safeGetString(dbResult,"value"));
          parameters.add(parameter);
        }
        return parameters;
      }
  finally {
        dbResult.close();
      }
    }
  finally {
      dbStat.close();
    }
  }
 catch (  SQLException ex) {
    throw new DBException(ex,this);
  }
 finally {
    session.close();
  }
}
