{
  super.initialize(monitor);
  dataTypeCache.getObjects(monitor,this);
  JDBCSession session=openSession(monitor,DBCExecutionPurpose.META,"Load basic datasource metadata");
  try {
{
      engines=new ArrayList<MSSQLEngine>();
      JDBCPreparedStatement dbStat=session.prepareStatement("SHOW ENGINES");
      try {
        JDBCResultSet dbResult=dbStat.executeQuery();
        try {
          while (dbResult.next()) {
            MSSQLEngine engine=new MSSQLEngine(this,dbResult);
            engines.add(engine);
          }
        }
  finally {
          dbResult.close();
        }
      }
 catch (      SQLException ex) {
      }
 finally {
        dbStat.close();
      }
    }
{
      charsets=new ArrayList<MSSQLCharset>();
      JDBCPreparedStatement dbStat=session.prepareStatement("SHOW CHARSET");
      try {
        JDBCResultSet dbResult=dbStat.executeQuery();
        try {
          while (dbResult.next()) {
            MSSQLCharset charset=new MSSQLCharset(this,dbResult);
            charsets.add(charset);
          }
        }
  finally {
          dbResult.close();
        }
      }
 catch (      SQLException ex) {
      }
 finally {
        dbStat.close();
      }
      Collections.sort(charsets,DBUtils.<MSSQLCharset>nameComparator());
      collations=new LinkedHashMap<String,MSSQLCollation>();
      dbStat=session.prepareStatement("SHOW COLLATION");
      try {
        JDBCResultSet dbResult=dbStat.executeQuery();
        try {
          while (dbResult.next()) {
            String charsetName=JDBCUtils.safeGetString(dbResult,MSSQLConstants.COL_CHARSET);
            MSSQLCharset charset=getCharset(charsetName);
            if (charset == null) {
              log.warn("Charset '" + charsetName + "' not found.");
              continue;
            }
            MSSQLCollation collation=new MSSQLCollation(charset,dbResult);
            collations.put(collation.getName(),collation);
            charset.addCollation(collation);
          }
        }
  finally {
          dbResult.close();
        }
      }
 catch (      SQLException ex) {
      }
 finally {
        dbStat.close();
      }
    }
    catalogCache.getObjects(monitor,this);
{
      try {
        JDBCPreparedStatement dbStat=session.prepareStatement("SELECT DATABASE()");
        try {
          JDBCResultSet resultSet=dbStat.executeQuery();
          try {
            resultSet.next();
            activeCatalogName=resultSet.getString(1);
          }
  finally {
            resultSet.close();
          }
        }
  finally {
          dbStat.close();
        }
      }
 catch (      SQLException e) {
        log.error(e);
      }
    }
  }
 catch (  SQLException ex) {
    throw new DBException("Error reading metadata",ex,this);
  }
 finally {
    session.close();
  }
}
