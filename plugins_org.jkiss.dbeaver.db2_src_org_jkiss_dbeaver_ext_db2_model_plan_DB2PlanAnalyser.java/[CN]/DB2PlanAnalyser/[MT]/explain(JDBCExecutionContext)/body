{
  Integer stmtNo=STMT_NO_GEN.incrementAndGet();
  String explainStmt=String.format(PT_EXPLAIN,stmtNo,query);
  LOG.debug("Schema=" + planTableSchema + " : "+ explainStmt);
  try {
    cleanExplainTables(context,stmtNo,planTableSchema);
    JDBCPreparedStatement dbStat=context.prepareStatement(String.format(PT_EXPLAIN,stmtNo,query));
    try {
      dbStat.execute();
    }
  finally {
      if (dbStat != null) {
        dbStat.close();
      }
    }
    dbStat=context.prepareStatement(String.format(SEL_STMT,planTableSchema));
    JDBCResultSet dbResult=null;
    try {
      dbStat.setInt(1,stmtNo);
      dbResult=dbStat.executeQuery();
      dbResult.next();
      db2PlanStatement=new DB2PlanStatement(context,dbResult,planTableSchema);
    }
  finally {
      if (dbResult != null) {
        dbResult.close();
      }
      if (dbStat != null) {
        dbStat.close();
      }
    }
    listNodes=db2PlanStatement.buildNodes();
    cleanExplainTables(context,stmtNo,planTableSchema);
  }
 catch (  SQLException e) {
    throw new DBCException(e);
  }
}
