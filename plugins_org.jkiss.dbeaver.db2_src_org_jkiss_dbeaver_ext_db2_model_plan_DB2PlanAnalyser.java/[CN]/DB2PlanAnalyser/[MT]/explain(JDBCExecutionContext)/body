{
  Integer stmtNo=STMT_NO_GEN.incrementAndGet();
  String planTableSchema=dataSource.getPlanTableSchemaName(context);
  LOG.error("schema=" + planTableSchema + " explain "+ stmtNo+ " for "+ query);
  try {
    if (planTableSchema == null) {
      throw new DBCException("Plan table not found - query can't be explained");
    }
    JDBCPreparedStatement dbStat=context.prepareStatement(String.format(PT_DELETE,planTableSchema));
    try {
      dbStat.setInt(1,stmtNo);
      dbStat.execute();
    }
  finally {
      if (dbStat != null) {
        dbStat.close();
      }
    }
    System.out.println("no=" + stmtNo + "q="+ query);
    dbStat=context.prepareStatement(String.format(PT_EXPLAIN,stmtNo,query));
    try {
      dbStat.execute();
    }
  finally {
      if (dbStat != null) {
        dbStat.close();
      }
    }
    dbStat=context.prepareStatement(String.format(SEL_STMT,planTableSchema));
    JDBCResultSet dbResult=null;
    try {
      dbStat.setInt(1,stmtNo);
      dbResult=dbStat.executeQuery();
      dbResult.next();
      db2PlanStatement=new DB2PlanStatement(context,dbResult,planTableSchema);
    }
  finally {
      if (dbResult != null) {
        dbResult.close();
      }
      if (dbStat != null) {
        dbStat.close();
      }
    }
    listNodes=db2PlanStatement.buildNodes();
  }
 catch (  SQLException e) {
    throw new DBCException(e);
  }
}
