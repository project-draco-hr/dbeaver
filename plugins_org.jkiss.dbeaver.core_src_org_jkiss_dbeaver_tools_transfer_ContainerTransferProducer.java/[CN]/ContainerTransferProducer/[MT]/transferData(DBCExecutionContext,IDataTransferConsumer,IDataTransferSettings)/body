{
  DBRProgressMonitor monitor=context.getProgressMonitor();
  long totalRows=0;
  if (settings.isQueryRowCount() && (dataContainer.getSupportedFeatures() & DBSDataContainer.DATA_COUNT) != 0) {
    monitor.beginTask(CoreMessages.dialog_export_wizard_job_task_retrieve,1);
    try {
      totalRows=dataContainer.countData(context,dataFilter);
    }
  finally {
      monitor.done();
    }
  }
  monitor.beginTask(CoreMessages.dialog_export_wizard_job_task_export_table_data,(int)totalRows);
  try {
    if (settings.getExtractType() == IDataTransferSettings.ExtractType.SINGLE_QUERY) {
      dataContainer.readData(context,consumer,dataFilter,-1,-1);
    }
 else {
      long offset=0;
      int segmentSize=settings.getSegmentSize();
      for (; ; ) {
        long rowCount=dataContainer.readData(context,consumer,dataFilter,offset,segmentSize);
        if (rowCount < segmentSize) {
          break;
        }
        offset+=rowCount;
      }
    }
  }
  finally {
    monitor.done();
  }
}
