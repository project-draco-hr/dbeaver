{
  try {
    WMIObjectCollectorSink sink=new WMIObjectCollectorSink(context.getProgressMonitor(),getNamespace().getService(),firstRow,maxRows);
    getNamespace().getService().enumInstances(getName(),sink,WMIConstants.WBEM_FLAG_SHALLOW);
    sink.waitForFinish();
    WMIResultSet resultSet=new WMIResultSet(context,this,sink.getObjectList());
    long resultCount=0;
    try {
      dataReceiver.fetchStart(context,resultSet);
      while (resultSet.nextRow()) {
        resultCount++;
        dataReceiver.fetchRow(context,resultSet);
      }
    }
  finally {
      try {
        dataReceiver.fetchEnd(context);
      }
 catch (      DBCException e) {
        log.error("Error while finishing result set fetch",e);
      }
      resultSet.close();
      dataReceiver.close();
    }
    return resultCount;
  }
 catch (  WMIException e) {
    throw new DBException("Can't enum instances",e);
  }
}
