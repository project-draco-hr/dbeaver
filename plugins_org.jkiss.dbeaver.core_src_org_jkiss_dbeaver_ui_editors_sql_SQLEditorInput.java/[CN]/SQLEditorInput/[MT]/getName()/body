{
  DBSDataSourceContainer dataSourceContainer=getDataSourceContainer();
  DBPPreferenceStore preferenceStore;
  if (dataSourceContainer != null) {
    preferenceStore=dataSourceContainer.getPreferenceStore();
  }
 else {
    preferenceStore=DBeaverCore.getGlobalPreferenceStore();
  }
  String pattern=preferenceStore.getString(DBeaverPreferences.SCRIPT_TITLE_PATTERN);
  Map<String,Object> vars=new HashMap<String,Object>();
  vars.put(VAR_CONNECTION_NAME,dataSourceContainer == null ? "?" : dataSourceContainer.getName());
  vars.put(VAR_FILE_NAME,scriptName);
  vars.put(VAR_FILE_EXT,getFile().getFullPath().getFileExtension());
  vars.put(VAR_DRIVER_NAME,dataSourceContainer == null ? "?" : dataSourceContainer.getDriver().getFullName());
  return TextUtils.replaceVariables(pattern,vars);
}
