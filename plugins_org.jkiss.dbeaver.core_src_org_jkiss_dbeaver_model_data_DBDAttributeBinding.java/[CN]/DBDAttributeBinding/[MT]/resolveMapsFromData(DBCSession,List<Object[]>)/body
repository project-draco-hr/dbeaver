{
  Map<DBSAttributeBase,Object> valueAttributes=new LinkedHashMap<DBSAttributeBase,Object>();
  for (int i=0; i < rows.size(); i++) {
    Object value=rows.get(i)[getOrdinalPosition()];
    if (value instanceof DBDCollection) {
      DBDCollection collection=(DBDCollection)value;
      if (collection.getItemCount() > 0) {
        value=collection.getItem(0);
      }
    }
    if (value instanceof DBDStructure) {
      DBSAttributeBase[] attributes=((DBDStructure)value).getAttributes();
      if (attributes != null) {
        for (        DBSAttributeBase attr : attributes) {
          valueAttributes.put(attr,((DBDStructure)value).getAttributeValue(attr));
        }
      }
    }
  }
  if (!valueAttributes.isEmpty()) {
    createNestedMapBindings(session,valueAttributes);
  }
}
