{
  List<Pair<DBSAttributeBase,Object[]>> valueAttributes=new ArrayList<Pair<DBSAttributeBase,Object[]>>();
  for (int i=0; i < rows.size(); i++) {
    Object value=rows.get(i)[getOrdinalPosition()];
    if (value instanceof DBDCollection) {
      DBDCollection collection=(DBDCollection)value;
      if (collection.getItemCount() > 0) {
        value=collection.getItem(0);
      }
    }
    if (value instanceof DBDStructure) {
      DBSAttributeBase[] attributes=((DBDStructure)value).getAttributes();
      for (      DBSAttributeBase attr : attributes) {
        Pair<DBSAttributeBase,Object[]> attrValue=null;
        for (        Pair<DBSAttributeBase,Object[]> pair : valueAttributes) {
          if (pair.getFirst().getName().equals(attr.getName())) {
            attrValue=pair;
            break;
          }
        }
        if (attrValue != null) {
          attrValue.getSecond()[i]=((DBDStructure)value).getAttributeValue(attr);
        }
 else {
          Object[] valueList=new Object[rows.size()];
          valueList[i]=((DBDStructure)value).getAttributeValue(attr);
          valueAttributes.add(new Pair<DBSAttributeBase,Object[]>(attr,valueList));
        }
      }
    }
  }
  if (!valueAttributes.isEmpty()) {
    createNestedMapBindings(session,valueAttributes);
  }
}
