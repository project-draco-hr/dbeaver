{
  final Spreadsheet spreadsheet=resultSetViewer.getSpreadsheet();
  if (!spreadsheet.isDisposed()) {
    if (!finished) {
      try {
        showProgress(spreadsheet);
      }
 catch (      Exception e) {
        log.error("Internal error during progress visualization",e);
        finishProgress(spreadsheet);
      }
    }
 else {
      finishProgress(spreadsheet);
    }
  }
  return Status.OK_STATUS;
}
