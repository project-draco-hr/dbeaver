{
  if (parent instanceof Collection) {
    return ((Collection)parent).toArray();
  }
 else   if (parent instanceof TreeNode) {
    return ((TreeNode)parent).children.toArray();
  }
 else {
    return new Object[0];
  }
}
