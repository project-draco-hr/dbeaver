{
  if (source instanceof DBSEntity) {
    for (    DBSEntityAttribute attr : ((DBSEntity)source).getAttributes(monitor)) {
      addAttributeMapping(monitor,attr);
    }
  }
 else {
    DBPDataSource dataSource=source.getDataSource();
    assert(dataSource != null);
    DBCSession session=dataSource.getDefaultContext(false).openSession(monitor,DBCExecutionPurpose.UTIL,"Read query meta data");
    try {
      MetadataReceiver receiver=new MetadataReceiver();
      source.readData(session,receiver,null,0,1,DBSDataContainer.FLAG_NONE);
      for (      DBCAttributeMetaData attr : receiver.attributes) {
        addAttributeMapping(monitor,attr);
      }
    }
  finally {
      session.close();
    }
  }
}
