{
  TemplateVariable[] variables=buffer.getVariables();
  for (int i=0; i != variables.length; i++) {
    TemplateVariable variable=variables[i];
    if (variable.getType().equals(GlobalTemplateVariables.Cursor.NAME))     return variable.getOffsets()[0];
  }
  return buffer.getString().length();
}
