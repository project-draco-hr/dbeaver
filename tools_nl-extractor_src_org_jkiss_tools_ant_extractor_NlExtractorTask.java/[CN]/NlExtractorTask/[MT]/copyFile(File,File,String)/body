{
  BufferedReader reader=new BufferedReader(new InputStreamReader(new FileInputStream(source)));
  OutputStreamWriter out;
  boolean doEncode=encoding != null && encoding.length() > 0;
  if (doEncode) {
    out=new OutputStreamWriter(new FileOutputStream(target),encoding);
  }
 else {
    out=new OutputStreamWriter(new FileOutputStream(target));
  }
  BufferedWriter writer=new BufferedWriter(out);
  String line=null;
  char[] convtBuf=new char[1024];
  while ((line=reader.readLine()) != null) {
    if (doEncode) {
      line=loadConvert(line.toCharArray(),0,line.length(),convtBuf);
    }
    writer.write(line);
    writer.newLine();
  }
  reader.close();
  writer.close();
}
