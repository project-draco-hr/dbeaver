{
  SQLStatementInfo sqlQuery;
  ITextSelection selection=(ITextSelection)getSelectionProvider().getSelection();
  String selText=selection.getText().trim();
  selText=SQLUtils.trimQueryStatement(getSyntaxManager(),selText);
  if (!CommonUtils.isEmpty(selText)) {
    sqlQuery=new SQLStatementInfo(selText);
    sqlQuery.setOffset(selection.getOffset());
    sqlQuery.setLength(selection.getLength());
  }
 else {
    sqlQuery=extractQueryAtPos(selection.getOffset());
  }
  if (sqlQuery == null || CommonUtils.isEmpty(sqlQuery.getQuery())) {
    return null;
  }
  sqlQuery.parseParameters(getDocument(),getSyntaxManager());
  return sqlQuery;
}
