{
  if (curAnnotations == null) {
    curAnnotations=new HashMap<Annotation,Position>();
  }
  List<Annotation> deletedAnnotations=new ArrayList<Annotation>();
  Map<Annotation,Position> newAnnotations=new HashMap<Annotation,Position>();
  for (  Map.Entry<Annotation,Position> entry : curAnnotations.entrySet()) {
    int entryOffset=entry.getValue().getOffset();
    if (entryOffset >= offset && entryOffset < offset + length) {
      deletedAnnotations.add(entry.getKey());
    }
  }
  for (  Annotation annotation : deletedAnnotations) {
    curAnnotations.remove(annotation);
  }
  for (  Position position : positions) {
    ProjectionAnnotation annotation=new ProjectionAnnotation();
    newAnnotations.put(annotation,position);
  }
  annotationModel.modifyAnnotations(deletedAnnotations.toArray(new Annotation[deletedAnnotations.size()]),newAnnotations,null);
  curAnnotations.putAll(newAnnotations);
}
