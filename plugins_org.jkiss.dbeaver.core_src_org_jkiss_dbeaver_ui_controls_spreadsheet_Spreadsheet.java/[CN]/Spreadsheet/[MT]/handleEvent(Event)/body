{
switch (event.type) {
case SWT.KeyDown:
    if (event.keyCode == SWT.CR || (event.keyCode >= SWT.KEYPAD_0 && event.keyCode <= SWT.KEYPAD_9) || (event.keyCode >= 'a' && event.keyCode <= 'z') || (event.keyCode >= '0' && event.keyCode <= '9')) {
      final Control editorControl=spreadsheetController.showCellEditor(true);
      if (editorControl != null && event.keyCode != SWT.CR) {
        final Event fwdEvent=new Event();
        fwdEvent.type=SWT.KeyDown;
        fwdEvent.character=event.character;
        fwdEvent.keyCode=event.keyCode;
        final Display display=editorControl.getDisplay();
        display.asyncExec(new Runnable(){
          @Override public void run(){
            display.post(fwdEvent);
          }
        }
);
      }
    }
 else     if (event.keyCode == SWT.ESC) {
      if (spreadsheetController != null) {
        spreadsheetController.resetCellValue(super.getFocusCell(),false);
      }
    }
  break;
case SWT.MouseDoubleClick:
GridPos pos=super.getCell(new Point(event.x,event.y));
GridPos focusPos=super.getFocusCell();
if (pos != null && focusPos != null && pos.equals(super.getFocusCell())) {
spreadsheetController.showCellEditor(false);
}
break;
case SWT.MouseDown:
if (event.button == 2) {
spreadsheetController.showCellEditor(true);
}
break;
case LightGrid.Event_ChangeSort:
spreadsheetController.changeSorting((GridColumn)event.data,event.stateMask);
break;
}
}
