{
  MenuManager menuMgr=new MenuManager();
  Menu menu=menuMgr.createContextMenu(this);
  menuMgr.addMenuListener(new IMenuListener(){
    @Override public void menuAboutToShow(    IMenuManager manager){
      manager.add(new GroupMarker(IWorkbenchActionConstants.MB_ADDITIONS));
      GridCell cell=posToCell(getFocusPos());
      if (cell != null) {
        spreadsheetController.fillContextMenu(cell,manager);
      }
    }
  }
);
  menuMgr.setRemoveAllWhenShown(true);
  super.setMenu(menu);
  site.registerContextMenu(menuMgr,selectionProvider);
}
