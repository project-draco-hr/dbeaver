{
  String[] contextIds=getContextTypeIds(document,offset);
  for (int i=0; i < contextIds.length; i++) {
    if (contextIds[i].equals(template.getContextTypeId())) {
      DocumentTemplateContext context=getContext(document,template,offset,length);
      return context.canEvaluate(template) || isTemplateAllowed(context,template);
    }
  }
  return false;
}
