{
  for (  final ColumnInfo columnInfo : getVisibleColumns()) {
    if (viewer instanceof TreeViewer) {
      final TreeViewerColumn item=new TreeViewerColumn((TreeViewer)viewer,columnInfo.style);
      final TreeColumn column=item.getColumn();
      column.setText(columnInfo.name);
      column.setMoveable(columnsMovable);
      column.setWidth(columnInfo.width);
      if (!CommonUtils.isEmpty(columnInfo.description)) {
        column.setToolTipText(columnInfo.description);
      }
      item.setLabelProvider(columnInfo.labelProvider);
      column.addControlListener(new ControlListener(){
        @Override public void controlMoved(        ControlEvent e){
        }
        @Override public void controlResized(        ControlEvent e){
          columnInfo.width=column.getWidth();
          saveColumnConfig();
        }
      }
);
      columnInfo.column=column;
    }
 else     if (viewer instanceof TableViewer) {
      final TableViewerColumn item=new TableViewerColumn((TableViewer)viewer,columnInfo.style);
      final TableColumn column=item.getColumn();
      column.setText(columnInfo.name);
      column.setMoveable(columnsMovable);
      column.setWidth(columnInfo.width);
      if (!CommonUtils.isEmpty(columnInfo.description)) {
        column.setToolTipText(columnInfo.description);
      }
      item.setLabelProvider(columnInfo.labelProvider);
      column.addControlListener(new ControlListener(){
        @Override public void controlMoved(        ControlEvent e){
        }
        @Override public void controlResized(        ControlEvent e){
          columnInfo.width=column.getWidth();
          saveColumnConfig();
        }
      }
);
      columnInfo.column=column;
    }
  }
}
