{
  DBSDataSourceContainer dataSourceContainer=getCurrentConnection(event);
  if (dataSourceContainer == null) {
    return null;
  }
  IWorkbenchWindow workbenchWindow=HandlerUtil.getActiveWorkbenchWindow(event);
  IFolder scriptFolder=getCurrentFolder(event);
  if (scriptFolder != null) {
    IProject project=dataSourceContainer.getRegistry().getProject();
    try {
      IFile scriptFile=ScriptsHandlerImpl.createNewScript(project,scriptFolder,dataSourceContainer);
      NavigatorHandlerObjectOpen.openResource(scriptFile,workbenchWindow);
    }
 catch (    CoreException e) {
      log.error(e);
    }
  }
 else {
    openRecentScript(workbenchWindow,dataSourceContainer,null);
  }
  return null;
}
