{
  this.query=query;
  this.offset=offset;
  this.length=length;
  try {
    statement=CCJSqlParserUtil.parse(query);
    if (statement instanceof Select) {
      type=SQLQueryType.SELECT;
    }
 else     if (statement instanceof Insert) {
      type=SQLQueryType.INSERT;
    }
 else     if (statement instanceof Update) {
      type=SQLQueryType.UPDATE;
    }
 else     if (statement instanceof Delete) {
      type=SQLQueryType.DELETE;
    }
 else {
      type=SQLQueryType.DDL;
    }
  }
 catch (  JSQLParserException e) {
    this.type=SQLQueryType.UNLKNOWN;
    log.debug("Error parsing SQL query [" + query + "]:"+ CommonUtils.getRootCause(e).getMessage());
  }
}
