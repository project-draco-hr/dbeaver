{
  setName(NLS.bind(CoreMessages.dialog_export_wizard_job_container_name,transferPipe.getProducer().getSourceObject().getName()));
  String contextTask=CoreMessages.dialog_export_wizard_job_task_export;
  DBPDataSource dataSource=transferPipe.getProducer().getSourceObject().getDataSource();
  DBCExecutionContext context=settings.isOpenNewConnections() ? dataSource.openIsolatedContext(monitor,DBCExecutionPurpose.UTIL,contextTask) : dataSource.openContext(monitor,DBCExecutionPurpose.UTIL,contextTask);
  try {
    if (settings.getFormatterProfile() != null) {
      context.setDataFormatterProfile(settings.getFormatterProfile());
    }
    transferPipe.getProducer().transferData(context,transferPipe.getConsumer(),settings);
  }
 catch (  Exception e) {
    new DataTransferErrorJob(e).schedule();
  }
 finally {
    context.close();
  }
}
