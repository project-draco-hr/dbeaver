{
  FromItem fromItem=select.getFromItem();
  String tableAlias=fromItem.getAlias() == null ? null : fromItem.getAlias().getName();
  if (filter.hasConditions()) {
    StringBuilder whereString=new StringBuilder();
    SQLUtils.appendConditionString(filter,dataSource,tableAlias,whereString,true);
    Expression filterWhere;
    try {
      filterWhere=CCJSqlParserUtil.parseCondExpression(whereString.toString());
    }
 catch (    JSQLParserException e) {
      throw new JSQLParserException("Bad query condition: [" + whereString + "]",e);
    }
    Expression sourceWhere=select.getWhere();
    if (sourceWhere == null) {
      select.setWhere(filterWhere);
    }
 else {
      select.setWhere(new AndExpression(new Parenthesis(sourceWhere),filterWhere));
    }
  }
  if (filter.hasOrdering()) {
    List<OrderByElement> orderByElements=select.getOrderByElements();
    if (orderByElements == null) {
      orderByElements=new ArrayList<OrderByElement>();
      select.setOrderByElements(orderByElements);
    }
    Table orderTable=tableAlias == null ? null : new Table(tableAlias);
    for (    DBDAttributeConstraint co : filter.getOrderConstraints()) {
      Expression orderExpr=new Column(orderTable,DBUtils.getObjectFullName(co.getAttribute()));
      OrderByElement element=new OrderByElement();
      element.setExpression(orderExpr);
      if (co.isOrderDescending()) {
        element.setAsc(false);
        element.setAscDescPresent(true);
      }
      orderByElements.add(element);
    }
  }
}
