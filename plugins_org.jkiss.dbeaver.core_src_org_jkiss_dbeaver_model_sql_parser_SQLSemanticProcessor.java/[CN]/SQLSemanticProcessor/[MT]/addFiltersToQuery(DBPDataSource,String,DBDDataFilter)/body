{
  boolean supportSubqueries=dataSource instanceof SQLDataSource && ((SQLDataSource)dataSource).getSQLDialect().supportsSubqueries();
  try {
    Statement statement=CCJSqlParserUtil.parse(sqlQuery);
    if (statement instanceof Select && ((Select)statement).getSelectBody() instanceof PlainSelect) {
      PlainSelect select=(PlainSelect)((Select)statement).getSelectBody();
      if (!supportSubqueries || CommonUtils.isEmpty(select.getJoins())) {
        patchSelectQuery(dataSource,select,dataFilter);
        return statement.toString();
      }
    }
    return wrapQuery(dataSource,sqlQuery,dataFilter);
  }
 catch (  Exception e) {
    throw new DBException("SQL parse error",e);
  }
}
