{
  if (dataSource != null) {
    final DBCTransactionManager txnManager=DBUtils.getTransactionManager(dataSource);
    if (updateConnection && txnManager != null) {
      try {
        DBeaverUI.runInProgressDialog(new DBRRunnableWithProgress(){
          @Override public void run(          DBRProgressMonitor monitor) throws InvocationTargetException, InterruptedException {
            try {
              txnManager.setAutoCommit(monitor,autoCommit);
            }
 catch (            DBCException e) {
              throw new InvocationTargetException(e);
            }
          }
        }
);
      }
 catch (      InvocationTargetException e) {
        UIUtils.showErrorDialog(null,"Auto-Commit","Error while toggle auto-commit",e.getTargetException());
        return;
      }
    }
  }
  if (autoCommit == getConnectionInfo().getConnectionType().isAutocommit()) {
    preferenceStore.setToDefault(DBeaverPreferences.DEFAULT_AUTO_COMMIT);
  }
 else {
    preferenceStore.setValue(DBeaverPreferences.DEFAULT_AUTO_COMMIT,autoCommit);
  }
}
