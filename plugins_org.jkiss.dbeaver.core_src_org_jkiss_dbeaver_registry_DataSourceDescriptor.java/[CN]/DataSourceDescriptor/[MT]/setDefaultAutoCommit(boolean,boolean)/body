{
  if (updateConnection && dataSource != null) {
    try {
      DBeaverUI.runInProgressDialog(new DBRRunnableWithProgress(){
        @Override public void run(        DBRProgressMonitor monitor) throws InvocationTargetException, InterruptedException {
          DBCSession session=dataSource.openSession(monitor,DBCExecutionPurpose.UTIL,"Change '" + getName() + "' transactional mode to "+ (autoCommit ? "auto-commit" : "manual"));
          try {
            DBCTransactionManager txnManager=session.getTransactionManager();
            txnManager.setAutoCommit(autoCommit);
          }
 catch (          DBCException e) {
            throw new InvocationTargetException(e);
          }
 finally {
            session.close();
          }
        }
      }
);
    }
 catch (    InvocationTargetException e) {
      UIUtils.showErrorDialog(null,"Auto-Commit","Error while toggle auto-commit",e.getTargetException());
      return;
    }
  }
  if (autoCommit == getConnectionInfo().getConnectionType().isAutocommit()) {
    getPreferenceStore().setToDefault(DBeaverPreferences.DEFAULT_AUTO_COMMIT);
  }
 else {
    getPreferenceStore().setValue(DBeaverPreferences.DEFAULT_AUTO_COMMIT,autoCommit);
  }
}
