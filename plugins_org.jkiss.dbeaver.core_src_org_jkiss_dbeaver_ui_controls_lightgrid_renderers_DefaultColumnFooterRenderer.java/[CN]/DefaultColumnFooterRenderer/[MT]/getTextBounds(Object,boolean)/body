{
  GridColumn column=(GridColumn)value;
  int x=leftMargin;
  if (column.getImage() != null) {
    x+=column.getImage().getBounds().width + imageSpacing;
  }
  int y=getBounds().height - bottomMargin - grid.sizingGC.getFontMetrics().getHeight();
  Rectangle bounds=new Rectangle(x,y,0,0);
  Point p=grid.sizingGC.stringExtent(column.getText());
  bounds.height=p.y;
  if (preferred) {
    bounds.width=p.x;
  }
 else {
    int width=getBounds().width - x;
    if (!column.isSortable()) {
      width-=rightMargin;
    }
    bounds.width=width;
  }
  return bounds;
}
