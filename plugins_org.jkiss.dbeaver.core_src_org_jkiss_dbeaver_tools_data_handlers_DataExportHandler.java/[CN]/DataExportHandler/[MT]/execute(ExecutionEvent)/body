{
  final IWorkbenchWindow workbenchWindow=HandlerUtil.getActiveWorkbenchWindow(event);
  final ISelection selection=HandlerUtil.getCurrentSelection(event);
  if (!(selection instanceof IStructuredSelection)) {
    return null;
  }
  IStructuredSelection ss=(IStructuredSelection)selection;
  final List<DataTransferProducer> dataProducers=new ArrayList<DataTransferProducer>();
  for (Iterator<?> iter=ss.iterator(); iter.hasNext(); ) {
    Object object=iter.next();
    final DBSDataContainer adapted=RuntimeUtils.getObjectAdapter(object,DBSDataContainer.class);
    if (adapted != null) {
      dataProducers.add(new DataTransferProducer(adapted));
    }
  }
  if (!dataProducers.isEmpty()) {
    ActiveWizardDialog dialog=new ActiveWizardDialog(workbenchWindow,new DataExportWizard(dataProducers));
    dialog.open();
  }
  return null;
}
