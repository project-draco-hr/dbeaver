{
  final JDBCDataSourceInfo info=new JDBCDataSourceInfo(metaData);
  for (  String kw : DB2Constants.ADVANCED_KEYWORDS) {
    info.addSQLKeyword(kw);
  }
  version=DB2Constants.DB2v99_9;
  try {
    version=Integer.valueOf(metaData.getDatabaseMajorVersion()).doubleValue();
    version+=Integer.valueOf(metaData.getDatabaseMinorVersion()).doubleValue() / 10;
  }
 catch (  SQLException e) {
    LOG.warn("SQLException when reading database version. Set it to " + DB2Constants.DB2v99_9 + " : "+ e.getMessage());
  }
  LOG.debug("Database version : " + version);
  planTableSchemaName=getContainer().getPreferenceStore().getString(DB2Constants.PREF_EXPLAIN_TABLE_SCHEMA_NAME);
  if (CommonUtils.isEmpty(planTableSchemaName)) {
    LOG.debug("planTableSchemaName was not set in preferences, set it to default :" + DB2Constants.PREF_EXPLAIN_TABLE_SCHEMA_NAME_DEFAULT);
    planTableSchemaName=DB2Constants.PREF_EXPLAIN_TABLE_SCHEMA_NAME_DEFAULT;
    getContainer().getPreferenceStore().setValue(DB2Constants.PREF_EXPLAIN_TABLE_SCHEMA_NAME,planTableSchemaName);
  }
  return info;
}
