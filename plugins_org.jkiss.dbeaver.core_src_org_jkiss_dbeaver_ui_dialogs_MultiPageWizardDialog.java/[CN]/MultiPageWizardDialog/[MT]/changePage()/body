{
  pageArea.setRedraw(false);
  try {
    TreeItem[] selection=pagesTree.getSelection();
    if (selection.length != 1) {
      return;
    }
    TreeItem newItem=selection[0];
    if (prevPage == newItem.getData()) {
      return;
    }
    GridData gd=(GridData)prevPage.getControl().getLayoutData();
    gd.exclude=true;
    prevPage.setVisible(false);
    if (prevPage instanceof ActiveWizardPage) {
      ((ActiveWizardPage)prevPage).deactivatePage();
    }
    IDialogPage page=(IDialogPage)newItem.getData();
    if (page instanceof ActiveWizardPage) {
      ((ActiveWizardPage)page).activatePage();
    }
    gd=(GridData)page.getControl().getLayoutData();
    gd.exclude=false;
    page.setVisible(true);
    prevPage=page;
    pageArea.layout();
  }
  finally {
    pageArea.setRedraw(true);
  }
}
