{
  readRequiredMeta(context.getProgressMonitor());
  StringBuilder query=new StringBuilder();
  query.append("UPDATE ").append(getFullQualifiedName()).append(" SET ");
  boolean hasKey=false;
  for (  DBSEntityAttribute attribute : updateAttributes) {
    if (hasKey)     query.append(",");
    hasKey=true;
    query.append(DBUtils.getQuotedIdentifier(getDataSource(),attribute.getName())).append("=?");
  }
  query.append(" WHERE ");
  hasKey=false;
  for (  DBSEntityAttribute attribute : keyAttributes) {
    if (hasKey)     query.append(" AND ");
    hasKey=true;
    query.append(DBUtils.getQuotedIdentifier(getDataSource(),attribute.getName())).append("=?");
  }
  DBCStatement dbStat=context.prepareStatement(DBCStatementType.QUERY,query.toString(),false,false,keysReceiver != null);
  dbStat.setDataContainer(this);
  DBSEntityAttribute[] attributes=new DBSEntityAttribute[keyAttributes.length + updateAttributes.length];
  System.arraycopy(updateAttributes,0,attributes,0,updateAttributes.length);
  System.arraycopy(keyAttributes,0,attributes,updateAttributes.length,keyAttributes.length);
  return new BatchImpl(dbStat,attributes,keysReceiver);
}
