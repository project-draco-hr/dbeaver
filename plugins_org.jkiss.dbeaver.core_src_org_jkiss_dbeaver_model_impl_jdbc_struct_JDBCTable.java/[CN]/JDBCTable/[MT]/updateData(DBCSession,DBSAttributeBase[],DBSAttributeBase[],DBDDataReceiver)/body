{
  readRequiredMeta(session.getProgressMonitor());
  String tableAlias=null;
  SQLDialect dialect=((SQLDataSource)session.getDataSource()).getSQLDialect();
  if (dialect.supportsAliasInUpdate()) {
    tableAlias=DEFAULT_TABLE_ALIAS;
  }
  StringBuilder query=new StringBuilder();
  query.append("UPDATE ").append(getFullQualifiedName());
  if (tableAlias != null) {
    query.append(' ').append(tableAlias);
  }
  query.append(" SET ");
  boolean hasKey=false;
  for (  DBSAttributeBase attribute : updateAttributes) {
    if (hasKey)     query.append(",");
    hasKey=true;
    if (tableAlias != null) {
      query.append(tableAlias).append(dialect.getStructSeparator());
    }
    query.append(getAttributeName(attribute)).append("=?");
  }
  query.append(" WHERE ");
  hasKey=false;
  for (  DBSAttributeBase attribute : keyAttributes) {
    if (hasKey)     query.append(" AND ");
    hasKey=true;
    DBDPseudoAttribute pseudoAttribute=null;
    if (attribute.isPseudoAttribute()) {
      if (attribute instanceof DBDAttributeBinding) {
        pseudoAttribute=((DBDAttributeBinding)attribute).getMetaAttribute().getPseudoAttribute();
      }
 else       if (attribute instanceof DBCAttributeMetaData) {
        pseudoAttribute=((DBCAttributeMetaData)attribute).getPseudoAttribute();
      }
    }
    if (pseudoAttribute != null) {
      String criteria=pseudoAttribute.getQueryExpression().replace("$alias",tableAlias != null ? tableAlias : getName());
      query.append(criteria);
    }
 else {
      if (tableAlias != null) {
        query.append(tableAlias).append(dialect.getStructSeparator());
      }
      query.append(getAttributeName(attribute));
    }
    query.append("=?");
  }
  DBCStatement dbStat=session.prepareStatement(DBCStatementType.QUERY,query.toString(),false,false,keysReceiver != null);
  dbStat.setStatementSource(this);
  DBSAttributeBase[] attributes=ArrayUtils.concatArrays(updateAttributes,keyAttributes);
  return new BatchImpl(dbStat,attributes,keysReceiver,false);
}
