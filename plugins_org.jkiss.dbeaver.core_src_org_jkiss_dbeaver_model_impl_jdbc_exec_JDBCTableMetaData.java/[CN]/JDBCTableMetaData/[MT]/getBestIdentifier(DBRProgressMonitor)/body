{
  if (identifiers == null) {
    identifiers=new ArrayList<JDBCTableIdentifier>(2);
    DBSEntity table=getEntity(monitor);
    if (table != null) {
      for (      JDBCColumnMetaData column : columns) {
        DBDPseudoAttribute pseudoAttribute=column.getPseudoAttribute();
        if (pseudoAttribute != null && pseudoAttribute.getType() == DBDPseudoAttributeType.ROWID) {
          identifiers.add(new JDBCTableIdentifier(monitor,new DBDPseudoReferrer(table,column),this));
          break;
        }
      }
      if (table instanceof DBSTable && ((DBSTable)table).isView()) {
      }
 else       if (identifiers.isEmpty()) {
        Collection<? extends DBSEntityConstraint> constraints=table.getConstraints(monitor);
        if (!CommonUtils.isEmpty(constraints)) {
          for (          DBSEntityConstraint constraint : constraints) {
            if (constraint instanceof DBSEntityReferrer && constraint.getConstraintType().isUnique()) {
              identifiers.add(new JDBCTableIdentifier(monitor,(DBSEntityReferrer)constraint,this));
            }
          }
        }
        if (identifiers.isEmpty() && table instanceof DBSTable) {
          try {
            Collection<? extends DBSTableIndex> indexes=((DBSTable)table).getIndexes(monitor);
            if (!CommonUtils.isEmpty(indexes)) {
              for (              DBSTableIndex index : indexes) {
                if (index.isUnique()) {
                  identifiers.add(new JDBCTableIdentifier(monitor,index,this));
                  break;
                }
              }
            }
          }
 catch (          DBException e) {
            log.debug(e);
          }
        }
      }
      if (CommonUtils.isEmpty(identifiers)) {
        DBVEntity virtualEntity=table.getDataSource().getContainer().getVirtualModel().findEntity(table,true);
        identifiers.add(new JDBCTableIdentifier(monitor,virtualEntity.getBestIdentifier(),this));
      }
    }
  }
  if (!CommonUtils.isEmpty(identifiers)) {
    DBCEntityIdentifier uniqueId=null;
    for (    DBCEntityIdentifier id : identifiers) {
      DBSEntityReferrer referrer=id.getReferrer();
      if (referrer != null && isGoodReferrer(monitor,referrer)) {
        if (referrer.getConstraintType() == DBSEntityConstraintType.PRIMARY_KEY) {
          return id;
        }
 else         if (referrer.getConstraintType().isUnique() || (referrer instanceof DBSTableIndex && ((DBSTableIndex)referrer).isUnique())) {
          uniqueId=id;
        }
      }
    }
    return uniqueId;
  }
  return null;
}
