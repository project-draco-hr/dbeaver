{
  try {
    DBSObjectFilter ksFilters=getContainer().getObjectFilter(CassandraKeyspace.class,null);
    List<CassandraKeyspace> tmpKeyspaces=new ArrayList<CassandraKeyspace>();
    JDBCResultSet dbResult;
    try {
      dbResult=session.getMetaData().getSchemas(null,ksFilters != null && ksFilters.hasSingleMask() ? ksFilters.getSingleMask() : null);
    }
 catch (    Throwable e) {
      dbResult=session.getMetaData().getSchemas();
    }
    try {
      while (dbResult.next()) {
        if (session.getProgressMonitor().isCanceled()) {
          break;
        }
        String ksName=JDBCUtils.safeGetString(dbResult,JDBCConstants.TABLE_SCHEM);
        if (CommonUtils.isEmpty(ksName)) {
          continue;
        }
        if (ksFilters != null && !ksFilters.matches(ksName)) {
          continue;
        }
        session.getProgressMonitor().subTask("Keyspace " + ksName);
        CassandraKeyspace keyspace=new CassandraKeyspace(this,ksName,dbResult);
        tmpKeyspaces.add(keyspace);
      }
    }
  finally {
      dbResult.close();
    }
    return tmpKeyspaces;
  }
 catch (  Exception ex) {
    log.error("Could not read keyspace list",ex);
    return null;
  }
}
