{
  if (file != null) {
    Bundle plugin=DBeaverActivator.getInstance().getBundle();
    URL url=FileLocator.find(plugin,Path.fromOSString(file),null);
    if (url != null) {
      InputStream bundleStream=null;
      InputStream stream=null;
      try {
        ResourceBundle bundle=null;
        if (translations != null) {
          URL bundleURL=FileLocator.find(plugin,Path.fromOSString(translations),null);
          if (bundleURL != null) {
            bundleStream=bundleURL.openStream();
            bundle=new PropertyResourceBundle(bundleStream);
          }
        }
        stream=new BufferedInputStream(url.openStream());
        TemplateReaderWriter reader=new TemplateReaderWriter();
        TemplatePersistenceData[] datas=reader.read(stream,bundle);
        for (        TemplatePersistenceData data : datas) {
          if (data.isCustom()) {
            if (data.getId() == null)             log.error("No template id specified");
 else             log.error("Template " + data.getTemplate().getName() + " deleted");
          }
 else           if (validateTemplate(data.getTemplate())) {
            templates.add(data);
          }
        }
      }
  finally {
        ContentUtils.close(bundleStream);
        ContentUtils.close(stream);
      }
    }
  }
}
