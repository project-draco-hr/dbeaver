{
  final Color backgroundColor=unassigned || dataSource != null ? getColor(SQLSyntaxManager.CONFIG_COLOR_BACKGROUND,SWT.COLOR_WHITE) : getColor(SQLSyntaxManager.CONFIG_COLOR_DISABLED,SWT.COLOR_WIDGET_LIGHT_SHADOW);
  final IToken keywordToken=new Token(new TextAttribute(getColor(SQLSyntaxManager.CONFIG_COLOR_KEYWORD),backgroundColor,SWT.BOLD));
  final IToken typeToken=new Token(new TextAttribute(getColor(SQLSyntaxManager.CONFIG_COLOR_DATATYPE),backgroundColor,SWT.BOLD));
  final IToken stringToken=new Token(new TextAttribute(getColor(SQLSyntaxManager.CONFIG_COLOR_STRING),backgroundColor,SWT.NORMAL));
  final IToken quotedToken=new Token(new TextAttribute(getColor(SQLSyntaxManager.CONFIG_COLOR_DATATYPE),backgroundColor,SWT.NORMAL));
  final IToken numberToken=new Token(new TextAttribute(getColor(SQLSyntaxManager.CONFIG_COLOR_NUMBER),backgroundColor,SWT.NORMAL));
  final IToken commentToken=new SQLCommentToken(new TextAttribute(getColor(SQLSyntaxManager.CONFIG_COLOR_COMMENT),backgroundColor,SWT.NORMAL));
  final SQLDelimiterToken delimiterToken=new SQLDelimiterToken(new TextAttribute(getColor(SQLSyntaxManager.CONFIG_COLOR_DELIMITER,SWT.COLOR_RED),backgroundColor,SWT.NORMAL));
  final SQLParameterToken parameterToken=new SQLParameterToken(new TextAttribute(getColor(SQLSyntaxManager.CONFIG_COLOR_PARAMETER,SWT.COLOR_DARK_BLUE),backgroundColor,SWT.BOLD));
  final IToken otherToken=new Token(new TextAttribute(getColor(SQLSyntaxManager.CONFIG_COLOR_TEXT),backgroundColor,SWT.NORMAL));
  final SQLBlockBeginToken blockBeginToken=new SQLBlockBeginToken(new TextAttribute(getColor(SQLSyntaxManager.CONFIG_COLOR_KEYWORD),backgroundColor,SWT.BOLD));
  final SQLBlockEndToken blockEndToken=new SQLBlockEndToken(new TextAttribute(getColor(SQLSyntaxManager.CONFIG_COLOR_KEYWORD),backgroundColor,SWT.BOLD));
  setDefaultReturnToken(otherToken);
  List<IRule> rules=new ArrayList<IRule>();
  for (  String lineComment : sqlDialect.getSingleLineComments()) {
    if (lineComment.startsWith("^")) {
      rules.add(new LineCommentRule(lineComment,commentToken));
    }
 else {
      rules.add(new EndOfLineRule(lineComment,commentToken));
    }
  }
  if (quoteSymbol != null) {
    rules.add(new SingleLineRule(quoteSymbol,quoteSymbol,quotedToken,escapeChar));
  }
  if (quoteSymbol == null || !quoteSymbol.equals(SQLConstants.STR_QUOTE_SINGLE)) {
    rules.add(new NestedMultiLineRule(SQLConstants.STR_QUOTE_SINGLE,SQLConstants.STR_QUOTE_SINGLE,stringToken,escapeChar));
  }
  if (quoteSymbol == null || !quoteSymbol.equals(SQLConstants.STR_QUOTE_DOUBLE)) {
    rules.add(new SingleLineRule(SQLConstants.STR_QUOTE_DOUBLE,SQLConstants.STR_QUOTE_DOUBLE,quotedToken,escapeChar));
  }
  Pair<String,String> multiLineComments=sqlDialect.getMultiLineComments();
  if (multiLineComments != null) {
    rules.add(new MultiLineRule(multiLineComments.getFirst(),multiLineComments.getSecond(),commentToken,(char)0,true));
  }
  rules.add(new WhitespaceRule(new TextWhiteSpaceDetector()));
  rules.add(new NumberRule(numberToken));
{
    WordRule delimRule=new WordRule(new IWordDetector(){
      @Override public boolean isWordStart(      char c){
        return SQLConstants.DEFAULT_STATEMENT_DELIMITER.charAt(0) == c || statementDelimiter.charAt(0) == Character.toLowerCase(c);
      }
      @Override public boolean isWordPart(      char c){
        return SQLConstants.DEFAULT_STATEMENT_DELIMITER.indexOf(c) != -1 || statementDelimiter.indexOf(Character.toLowerCase(c)) != -1;
      }
    }
,Token.UNDEFINED,true);
    delimRule.addWord(SQLConstants.DEFAULT_STATEMENT_DELIMITER,delimiterToken);
    if (!statementDelimiter.equals(SQLConstants.DEFAULT_STATEMENT_DELIMITER)) {
      delimRule.addWord(statementDelimiter,delimiterToken);
    }
    rules.add(delimRule);
  }
  WordRule wordRule=new WordRule(new SQLWordDetector(),otherToken,true);
  for (  String reservedWord : sqlDialect.getReservedWords()) {
    wordRule.addWord(reservedWord,keywordToken);
  }
  for (  String function : sqlDialect.getFunctions()) {
    wordRule.addWord(function,typeToken);
  }
  for (  String type : sqlDialect.getTypes()) {
    wordRule.addWord(type,typeToken);
  }
  wordRule.addWord(SQLConstants.BLOCK_BEGIN,blockBeginToken);
  wordRule.addWord(SQLConstants.BLOCK_END,blockEndToken);
  rules.add(wordRule);
{
    IRule parameterRule=new IRule(){
      private StringBuilder buffer=new StringBuilder();
      @Override public IToken evaluate(      ICharacterScanner scanner){
        int column=scanner.getColumn();
        if (column <= 0) {
          return Token.UNDEFINED;
        }
        scanner.unread();
        int prevChar=scanner.read();
        if (Character.isJavaIdentifierPart(prevChar) || prevChar == ':' || prevChar == '?' || prevChar == '\\' || prevChar == '/') {
          return Token.UNDEFINED;
        }
        int c=scanner.read();
        if (c != ICharacterScanner.EOF && (c == '?' || c == ':')) {
          buffer.setLength(0);
          do {
            buffer.append((char)c);
            c=scanner.read();
          }
 while (c != ICharacterScanner.EOF && Character.isJavaIdentifierPart(c));
          scanner.unread();
          if ((buffer.charAt(0) == '?' && buffer.length() == 1) || (buffer.charAt(0) == ':' && buffer.length() > 1)) {
            return parameterToken;
          }
          for (int i=buffer.length() - 1; i >= 0; i--) {
            scanner.unread();
          }
        }
 else {
          scanner.unread();
        }
        return Token.UNDEFINED;
      }
    }
;
    rules.add(parameterRule);
  }
  IRule[] result=new IRule[rules.size()];
  rules.toArray(result);
  setRules(result);
}
