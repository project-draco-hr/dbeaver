{
  return new ActionContributionItem(new Action(text,DBIcon.SQL_TEXT.getImageDescriptor()){
    @Override public void run(){
      DBeaverUI.runInUI(DBeaverUI.getActiveWorkbenchWindow(),runnable);
      String sql=runnable.getResult();
      IEditorPart activeEditor=DBeaverUI.getActiveWorkbenchWindow().getActivePage().getActiveEditor();
      if (activeEditor instanceof AbstractTextEditor) {
        AbstractTextEditor textEditor=(AbstractTextEditor)activeEditor;
        ITextSelection selection=(ITextSelection)textEditor.getSelectionProvider().getSelection();
        IDocumentProvider provider=textEditor.getDocumentProvider();
        IDocument doc=provider.getDocument(activeEditor.getEditorInput());
        try {
          doc.replace(selection.getOffset(),selection.getLength(),sql);
        }
 catch (        BadLocationException e) {
          log.warn(e);
        }
        activeEditor.setFocus();
      }
 else {
        UIUtils.setClipboardContents(DBeaverUI.getActiveWorkbenchShell().getDisplay(),TextTransfer.getInstance(),sql);
      }
    }
  }
);
}
