{
  if (!isEmbeddedDataSource() && container.getPreferenceStore().getBoolean(DBeaverPreferences.META_SEPARATE_CONNECTION)) {
synchronized (this) {
      this.metaContext=new JDBCExecutionContext(this,"Metadata reader",true);
      this.metaContext.connect(monitor,true,null);
    }
  }
  JDBCSession session=getDefaultContext(true).openSession(monitor,DBCExecutionPurpose.META,CoreMessages.model_html_read_database_meta_data);
  try {
    JDBCDatabaseMetaData metaData=session.getMetaData();
    sqlDialect=createSQLDialect(metaData);
    dataSourceInfo=createDataSourceInfo(metaData);
  }
 catch (  SQLException ex) {
    throw new DBException("Error getting JDBC meta data",ex,this);
  }
 finally {
    session.close();
  }
}
