{
  if (container.getPreferenceStore().getBoolean(DBeaverPreferences.META_SEPARATE_CONNECTION)) {
    this.metaContext=new JDBCExecutionContext(this,"Metadata reader",false);
    this.metaContext.connect(monitor,true,null);
  }
  JDBCSession session=openSession(monitor,DBCExecutionPurpose.META,CoreMessages.model_html_read_database_meta_data);
  try {
    JDBCDatabaseMetaData metaData=session.getMetaData();
    dataSourceInfo=createDataSourceInfo(metaData);
    sqlDialect=createSQLDialect(metaData);
  }
 catch (  SQLException ex) {
    throw new DBException("Error getting JDBC meta data",ex,this);
  }
 finally {
    session.close();
  }
}
