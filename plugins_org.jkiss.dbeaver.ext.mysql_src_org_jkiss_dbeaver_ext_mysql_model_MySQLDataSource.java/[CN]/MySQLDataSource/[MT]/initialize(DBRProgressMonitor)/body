{
  super.initialize(monitor);
  dataTypeCache.getAllObjects(monitor,this);
  try (JDBCSession session=getDefaultContext(true).openSession(monitor,DBCExecutionPurpose.META,"Load basic datasource metadata")){
{
      engines=new ArrayList<>();
      try (JDBCPreparedStatement dbStat=session.prepareStatement("SHOW ENGINES")){
        try (JDBCResultSet dbResult=dbStat.executeQuery()){
          while (dbResult.next()) {
            MySQLEngine engine=new MySQLEngine(this,dbResult);
            engines.add(engine);
          }
        }
       }
 catch (      SQLException ex) {
      }
    }
{
      charsets=new ArrayList<>();
      JDBCPreparedStatement dbStat=session.prepareStatement("SHOW CHARSET");
      try {
        try (JDBCResultSet dbResult=dbStat.executeQuery()){
          while (dbResult.next()) {
            MySQLCharset charset=new MySQLCharset(this,dbResult);
            charsets.add(charset);
          }
        }
       }
 catch (      SQLException ex) {
      }
 finally {
        dbStat.close();
      }
      Collections.sort(charsets,DBUtils.<MySQLCharset>nameComparator());
      collations=new LinkedHashMap<>();
      dbStat=session.prepareStatement("SHOW COLLATION");
      try {
        try (JDBCResultSet dbResult=dbStat.executeQuery()){
          while (dbResult.next()) {
            String charsetName=JDBCUtils.safeGetString(dbResult,MySQLConstants.COL_CHARSET);
            MySQLCharset charset=getCharset(charsetName);
            if (charset == null) {
              log.warn("Charset '" + charsetName + "' not found.");
              continue;
            }
            MySQLCollation collation=new MySQLCollation(charset,dbResult);
            collations.put(collation.getName(),collation);
            charset.addCollation(collation);
          }
        }
       }
 catch (      SQLException ex) {
      }
 finally {
        dbStat.close();
      }
    }
    catalogCache.getAllObjects(monitor,this);
{
      try {
        try (JDBCPreparedStatement dbStat=session.prepareStatement("SELECT DATABASE()")){
          try (JDBCResultSet resultSet=dbStat.executeQuery()){
            resultSet.next();
            activeCatalogName=resultSet.getString(1);
          }
         }
       }
 catch (      SQLException e) {
        log.error(e);
      }
    }
  }
 catch (  SQLException ex) {
    throw new DBException("Error reading metadata",ex,this);
  }
}
