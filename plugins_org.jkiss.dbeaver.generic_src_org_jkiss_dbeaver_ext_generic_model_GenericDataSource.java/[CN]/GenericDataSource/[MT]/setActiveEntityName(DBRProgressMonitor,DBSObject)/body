{
  JDBCSession session=openSession(monitor,DBCExecutionPurpose.UTIL,"Set active catalog");
  try {
    if (selectedEntityFromAPI) {
      if (selectedEntityType.equals(GenericConstants.ENTITY_TYPE_CATALOG)) {
        session.setCatalog(entity.getName());
      }
 else       if (selectedEntityType.equals(GenericConstants.ENTITY_TYPE_SCHEMA)) {
        session.setSchema(entity.getName());
      }
 else {
        throw new DBException("No API to change active entity if type '" + selectedEntityType + "'");
      }
    }
 else {
      if (CommonUtils.isEmpty(querySetActiveDB) || !(entity instanceof GenericObjectContainer)) {
        throw new DBException("Active database can't be changed for this kind of datasource!");
      }
      String changeQuery=querySetActiveDB.replaceFirst("\\?",entity.getName());
      JDBCPreparedStatement dbStat=session.prepareStatement(changeQuery);
      try {
        dbStat.execute();
      }
  finally {
        dbStat.close();
      }
    }
  }
 catch (  SQLException e) {
    throw new DBException(e);
  }
 finally {
    session.close();
  }
  selectedEntityName=entity.getName();
}
