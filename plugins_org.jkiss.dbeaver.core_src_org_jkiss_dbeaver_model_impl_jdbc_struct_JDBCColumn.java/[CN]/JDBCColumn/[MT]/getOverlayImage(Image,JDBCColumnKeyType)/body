{
  if (keyType == null || !(keyType.isInUniqueKey() || keyType.isInReferenceKey())) {
    return columnImage;
  }
synchronized (overlayCache) {
    Map<JDBCColumnKeyType,Image> keyTypeImageMap=overlayCache.get(columnImage);
    if (keyTypeImageMap == null) {
      keyTypeImageMap=new HashMap<JDBCColumnKeyType,Image>();
      overlayCache.put(columnImage,keyTypeImageMap);
    }
    Image finalImage=keyTypeImageMap.get(keyType);
    if (finalImage == null) {
      OverlayImageDescriptor overlay=new OverlayImageDescriptor(columnImage.getImageData());
      ImageDescriptor overImage=null;
      if (keyType.isInUniqueKey()) {
        overImage=DBIcon.OVER_KEY.getImageDescriptor();
      }
 else       if (keyType.isInReferenceKey()) {
        overImage=DBIcon.OVER_REFERENCE.getImageDescriptor();
      }
      if (overImage == null) {
        return columnImage;
      }
      overlay.setBottomRight(new ImageDescriptor[]{overImage});
      finalImage=overlay.createImage();
      keyTypeImageMap.put(keyType,finalImage);
    }
    return finalImage;
  }
}
