{
  Map<DBSEntity,DBDRowIdentifier> locatorMap=new HashMap<DBSEntity,DBDRowIdentifier>();
  try {
    for (    DBDAttributeBindingMeta binding : bindings) {
      DBCAttributeMetaData attrMeta=binding.getMetaAttribute();
      DBCEntityMetaData entityMeta=attrMeta.getEntityMetaData();
      Object metaSource=attrMeta.getSource();
      if (entityMeta == null && metaSource instanceof SQLQuery) {
        entityMeta=((SQLQuery)metaSource).getSingleSource();
      }
      DBSEntity entity=null;
      if (metaSource instanceof DBSEntity) {
        entity=(DBSEntity)metaSource;
      }
 else       if (entityMeta != null) {
        final DBSObjectContainer objectContainer=DBUtils.getAdapter(DBSObjectContainer.class,session.getDataSource());
        if (objectContainer != null) {
          String catalogName=entityMeta.getCatalogName();
          String schemaName=entityMeta.getSchemaName();
          String entityName=entityMeta.getEntityName();
          Class<? extends DBSObject> scChildType=objectContainer.getChildType(session.getProgressMonitor());
          DBSObject entityObject;
          if (!CommonUtils.isEmpty(catalogName) && scChildType != null && DBSSchema.class.isAssignableFrom(scChildType)) {
            entityObject=DBUtils.getObjectByPath(session.getProgressMonitor(),objectContainer,null,schemaName,entityName);
          }
 else {
            entityObject=DBUtils.getObjectByPath(session.getProgressMonitor(),objectContainer,catalogName,schemaName,entityName);
          }
          if (entityObject == null) {
            log.debug("Table '" + DBUtils.getSimpleQualifiedName(catalogName,schemaName,entityName) + "' not found in metadata catalog");
          }
 else           if (entityObject instanceof DBSEntity) {
            entity=(DBSEntity)entityObject;
          }
 else {
            log.debug("Unsupported table class: " + entityObject.getClass().getName());
          }
        }
      }
      if (entity != null) {
        DBSEntityAttribute tableColumn;
        if (attrMeta.getPseudoAttribute() != null) {
          tableColumn=attrMeta.getPseudoAttribute().createFakeAttribute(entity,attrMeta);
        }
 else {
          tableColumn=entity.getAttribute(session.getProgressMonitor(),attrMeta.getName());
        }
        binding.setEntityAttribute(tableColumn);
      }
    }
    for (    DBDAttributeBindingMeta binding : bindings) {
      DBSEntityAttribute attr=binding.getEntityAttribute();
      if (attr == null) {
        continue;
      }
      DBSEntity entity=attr.getParentObject();
      DBDRowIdentifier rowIdentifier=locatorMap.get(entity);
      if (rowIdentifier == null) {
        DBSEntityReferrer entityIdentifier=getBestIdentifier(session.getProgressMonitor(),entity,bindings);
        if (entityIdentifier != null) {
          rowIdentifier=new DBDRowIdentifier(entity,entityIdentifier);
          locatorMap.put(entity,rowIdentifier);
        }
      }
      binding.setRowIdentifier(rowIdentifier);
    }
    for (    DBDAttributeBinding binding : bindings) {
      binding.lateBinding(session,rows);
    }
    for (    DBDRowIdentifier rowIdentifier : locatorMap.values()) {
      rowIdentifier.reloadAttributes(session.getProgressMonitor(),bindings);
    }
  }
 catch (  DBException e) {
    log.error("Can't extract column identifier info",e);
  }
}
