{
  DBSEntityAttribute attribute=null;
  if (type instanceof DBSTableColumn) {
    attribute=(DBSTableColumn)type;
  }
 else   if (type instanceof DBDAttributeBinding) {
    attribute=((DBDAttributeBinding)type).getEntityAttribute();
  }
  if (attribute == null) {
    throw new SQLException("Can't find table column for column '" + index + "'");
  }
  MySQLTableColumn enumColumn;
  if (attribute instanceof MySQLTableColumn) {
    enumColumn=(MySQLTableColumn)attribute;
  }
 else {
    throw new SQLException("Bad column type: " + attribute.getClass().getName());
  }
  return new MySQLTypeEnum(enumColumn,resultSet.getString(index));
}
