{
  final DBSDataContainer dataContainer=dataProducer.getDataContainer();
  setName(NLS.bind(CoreMessages.dialog_export_wizard_job_container_name,dataContainer.getName()));
  String contextTask=CoreMessages.dialog_export_wizard_job_task_export;
  DBCExecutionContext context=settings.isOpenNewConnections() ? dataContainer.getDataSource().openIsolatedContext(monitor,DBCExecutionPurpose.UTIL,contextTask) : dataContainer.getDataSource().openContext(monitor,DBCExecutionPurpose.UTIL,contextTask);
  try {
    if (settings.getFormatterProfile() != null) {
      context.setDataFormatterProfile(settings.getFormatterProfile());
    }
    ExporterSite site=new ExporterSite(dataProducer);
    site.makeExport(context);
  }
 catch (  Exception e) {
    new DataExportErrorJob(e).schedule();
  }
 finally {
    context.close();
  }
}
