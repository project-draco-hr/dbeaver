{
  setName(NLS.bind(CoreMessages.dialog_export_wizard_job_container_name,dataProducer.getSourceObject().getName()));
  String contextTask=CoreMessages.dialog_export_wizard_job_task_export;
  DBPDataSource dataSource=dataProducer.getSourceObject().getDataSource();
  DBCExecutionContext context=settings.isOpenNewConnections() ? dataSource.openIsolatedContext(monitor,DBCExecutionPurpose.UTIL,contextTask) : dataSource.openContext(monitor,DBCExecutionPurpose.UTIL,contextTask);
  try {
    if (settings.getFormatterProfile() != null) {
      context.setDataFormatterProfile(settings.getFormatterProfile());
    }
    ExporterSite site=new ExporterSite(dataProducer);
    site.makeExport(context);
  }
 catch (  Exception e) {
    new DataExportErrorJob(e).schedule();
  }
 finally {
    context.close();
  }
}
