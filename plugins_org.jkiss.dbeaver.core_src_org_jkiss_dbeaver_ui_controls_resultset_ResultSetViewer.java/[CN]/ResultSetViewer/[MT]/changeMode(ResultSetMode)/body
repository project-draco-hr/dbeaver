{
  int oldRowNum=this.curRowNum, oldColNum=this.curColNum;
  if (oldRowNum < 0 && curRows.size() > 0) {
    oldRowNum=0;
  }
  this.mode=resultSetMode;
  if (this.mode == ResultSetMode.GRID) {
    this.spreadsheet.setRowHeaderWidth(DEFAULT_ROW_HEADER_WIDTH);
    this.initResultSet();
  }
 else {
    this.resetRecordHeaderWidth();
    this.updateRecordMode();
  }
  this.curRowNum=oldRowNum;
  this.curColNum=oldColNum;
  if (mode == ResultSetMode.GRID) {
    if (this.curRowNum >= 0 && this.curRowNum < spreadsheet.getItemCount()) {
      spreadsheet.setCursor(new GridPos(this.curColNum,this.curRowNum),false);
    }
  }
 else {
    if (this.curColNum >= 0) {
      spreadsheet.setCursor(new GridPos(0,this.curColNum),false);
    }
  }
  spreadsheet.layout(true,true);
}
