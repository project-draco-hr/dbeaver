{
  GridPos curPos=spreadsheet.getCursorPosition();
  int rowNum;
  if (mode == ResultSetMode.RECORD) {
    rowNum=this.curRowNum;
  }
 else {
    rowNum=curPos.row;
  }
  if (rowNum < 0 || rowNum >= curRows.size()) {
    return;
  }
  RowInfo rowInfo=new RowInfo(rowNum);
  if (addedRows.contains(rowInfo)) {
    addedRows.remove(rowInfo);
    cleanupRow(rowNum);
    refreshSpreadsheet(true);
  }
 else {
    removedRows.add(rowInfo);
    if (mode == ResultSetMode.GRID && curPos.row < spreadsheet.getItemCount() - 1) {
      curPos.row++;
      spreadsheet.setCursor(curPos,false);
    }
  }
  spreadsheet.redrawGrid();
  updateEditControls();
  fireResultSetChange();
}
