{
  if (spreadsheet.isDisposed()) {
    return;
  }
  if (rowsChanged) {
    if (curRowNum >= model.getRowCount()) {
      curRowNum=model.getRowCount() - 1;
    }
    GridPos curPos=new GridPos(spreadsheet.getCursorPosition());
    if (gridMode == GridMode.GRID) {
      if (curPos.row >= model.getRowCount()) {
        curPos.row=model.getRowCount() - 1;
      }
    }
    this.spreadsheet.reinitState(columnsChanged);
    if (gridMode == GridMode.GRID) {
      spreadsheet.setCursor(curPos,false);
    }
 else {
      updateRecordMode();
    }
  }
 else {
    this.spreadsheet.redrawGrid();
  }
}
