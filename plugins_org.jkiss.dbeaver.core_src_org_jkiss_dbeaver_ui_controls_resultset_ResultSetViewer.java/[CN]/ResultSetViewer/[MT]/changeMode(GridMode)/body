{
  int oldRowNum=this.curRowNum, oldColNum=this.curColNum;
  int rowCount=model.getRowCount();
  if (rowCount > 0) {
    if (oldRowNum < 0) {
      oldRowNum=this.curRowNum=0;
    }
 else     if (oldRowNum >= rowCount) {
      oldRowNum=this.curRowNum=rowCount - 1;
    }
  }
  this.gridMode=gridMode;
  if (this.gridMode == GridMode.GRID) {
    this.spreadsheet.setRowHeaderWidth(DEFAULT_ROW_HEADER_WIDTH);
    this.initResultSet();
  }
 else {
    this.resetRecordHeaderWidth();
    this.updateRecordMode();
  }
  this.curRowNum=oldRowNum;
  this.curColNum=oldColNum;
  if (gridMode == GridMode.GRID) {
    if (this.curRowNum >= 0 && this.curRowNum < spreadsheet.getItemCount()) {
      spreadsheet.setCursor(new GridPos(this.curColNum,this.curRowNum),false);
    }
  }
 else {
    if (this.curColNum >= 0) {
      spreadsheet.setCursor(new GridPos(0,this.curColNum),false);
    }
  }
  spreadsheet.layout(true,true);
  previewValue();
}
