{
  RowData oldRow=this.curRow;
  DBDAttributeBinding oldAttribute=this.curAttribute;
  int rowCount=model.getRowCount();
  if (rowCount > 0) {
    if (oldRow == null) {
      oldRow=this.curRow=model.getRow(0);
    }
 else     if (oldRow.visualNumber >= rowCount) {
      oldRow=this.curRow=model.getRow(rowCount - 1);
    }
  }
  if (oldAttribute == null && model.getVisibleColumnCount() > 0) {
    oldAttribute=model.getVisibleColumn(0);
  }
  this.gridMode=gridMode;
  if (this.gridMode == GridMode.GRID) {
    this.spreadsheet.setRowHeaderWidth(DEFAULT_ROW_HEADER_WIDTH);
    this.initResultSet();
  }
 else {
    this.resetRecordHeaderWidth();
    this.updateRecordMode();
  }
  if (gridMode == GridMode.GRID) {
    if (oldRow != null) {
      spreadsheet.setCursor(new GridCell(oldAttribute,oldRow),false);
    }
  }
 else {
    if (oldAttribute != null) {
      spreadsheet.setCursor(new GridCell(oldRow,oldAttribute),false);
    }
  }
  spreadsheet.layout(true,true);
  previewValue();
}
