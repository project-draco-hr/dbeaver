{
  if (!spreadsheet.isDisposed() && visibleColumns != null && mode == ResultSetMode.GRID) {
    for (int i=0, metaColumnsLength=visibleColumns.length; i < metaColumnsLength; i++) {
      DBDAttributeBinding column=visibleColumns[i];
      DBQOrderColumn columnOrder=dataFilter.getOrderColumn(column.getAttributeName());
      GridColumn gridColumn=spreadsheet.getColumn(i);
      if (columnOrder == null) {
        gridColumn.setSort(SWT.DEFAULT);
      }
 else {
        gridColumn.setSort(columnOrder.isDescending() ? SWT.UP : SWT.DOWN);
      }
    }
    spreadsheet.redrawGrid();
  }
}
