{
  if (!spreadsheet.isDisposed() && mode == ResultSetMode.GRID) {
    List<DBDAttributeBinding> visibleColumns=model.getVisibleColumns();
    for (int i=0, metaColumnsLength=visibleColumns.size(); i < metaColumnsLength; i++) {
      DBDAttributeBinding column=visibleColumns.get(i);
      DBQOrderColumn columnOrder=model.getDataFilter().getOrderColumn(column.getAttributeName());
      GridColumn gridColumn=spreadsheet.getColumn(i);
      if (columnOrder == null) {
        gridColumn.setSort(SWT.DEFAULT);
      }
 else {
        gridColumn.setSort(columnOrder.isDescending() ? SWT.UP : SWT.DOWN);
      }
    }
    spreadsheet.redrawGrid();
  }
}
