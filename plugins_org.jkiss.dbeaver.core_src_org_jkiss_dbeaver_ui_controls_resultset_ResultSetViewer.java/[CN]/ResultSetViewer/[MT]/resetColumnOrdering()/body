{
  if (!spreadsheet.isDisposed() && gridMode == GridMode.GRID) {
    List<DBDAttributeBinding> visibleColumns=model.getVisibleColumns();
    for (int i=0, metaColumnsLength=visibleColumns.size(); i < metaColumnsLength; i++) {
      DBDAttributeBinding column=visibleColumns.get(i);
      DBQAttributeConstraint constraint=model.getDataFilter().getConstraint(column);
      GridColumn gridColumn=spreadsheet.getColumn(i);
      if (constraint == null || constraint.getOrderBy() == null) {
        gridColumn.setSort(SWT.DEFAULT);
      }
 else {
        gridColumn.setSort(constraint.getOrderBy() == DBQOrder.DESCENDING ? SWT.UP : SWT.DOWN);
      }
    }
    spreadsheet.redrawGrid();
  }
}
