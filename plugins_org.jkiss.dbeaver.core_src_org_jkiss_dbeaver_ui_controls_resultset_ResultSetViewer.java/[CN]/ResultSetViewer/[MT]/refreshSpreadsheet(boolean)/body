{
  if (spreadsheet.isDisposed()) {
    return;
  }
  if (rowsChanged) {
    if (curRow.visualNumber >= model.getRowCount()) {
      curRow=model.getRow(model.getRowCount() - 1);
    }
    GridCell curCell=spreadsheet.getCursorCell();
    this.spreadsheet.refreshData(true);
    if (gridMode == GridMode.GRID) {
      if (curCell != null) {
        spreadsheet.setCursor(curCell,false);
      }
    }
 else {
      updateRecordMode();
    }
  }
 else {
    this.spreadsheet.redrawGrid();
  }
}
