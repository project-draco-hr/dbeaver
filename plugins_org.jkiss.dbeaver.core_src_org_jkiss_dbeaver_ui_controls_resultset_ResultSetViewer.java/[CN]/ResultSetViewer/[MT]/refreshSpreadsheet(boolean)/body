{
  if (spreadsheet.isDisposed()) {
    return;
  }
  if (rowsChanged) {
    int rowCount=model.getRowCount();
    if (curRow == null || curRow.visualNumber >= rowCount) {
      curRow=rowCount == 0 ? null : model.getRow(rowCount - 1);
    }
    GridCell curCell=spreadsheet.getCursorCell();
    if (!recordMode) {
      this.initResultSet();
      if (curCell != null) {
        spreadsheet.setCursor(curCell,false);
      }
    }
 else {
      updateRecordMode();
    }
  }
 else {
    this.spreadsheet.redrawGrid();
  }
}
