{
  GridCell curCell=spreadsheet.getCursorCell();
  Set<RowData> rowsToDelete=new LinkedHashSet<RowData>();
  if (gridMode == GridMode.RECORD) {
    rowsToDelete.add(model.getRow(curRowNum));
  }
 else {
    for (    GridCell cell : spreadsheet.getCellSelection()) {
      rowsToDelete.add((RowData)cell.row);
    }
  }
  if (rowsToDelete.isEmpty()) {
    return;
  }
  int rowsRemoved=0;
  int lastRowNum=-1;
  for (  RowData row : rowsToDelete) {
    if (model.deleteRow(row)) {
      rowsRemoved++;
    }
    lastRowNum=row.visualNumber;
  }
  if (gridMode == GridMode.GRID && lastRowNum < spreadsheet.getItemCount() - 1) {
    GridPos newPos=new GridPos(curColNum,lastRowNum - rowsRemoved + 1);
    spreadsheet.setCursor(newPos,false);
  }
  if (rowsRemoved > 0) {
    refreshSpreadsheet(false,true);
  }
 else {
    spreadsheet.redrawGrid();
  }
  updateEditControls();
  fireResultSetChange();
}
