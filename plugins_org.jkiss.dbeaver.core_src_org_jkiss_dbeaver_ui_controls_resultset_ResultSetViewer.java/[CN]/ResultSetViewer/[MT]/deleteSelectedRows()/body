{
  Set<RowData> rowsToDelete=new LinkedHashSet<RowData>();
  if (gridMode == GridMode.RECORD) {
    rowsToDelete.add(curRow);
  }
 else {
    for (    GridCell cell : spreadsheet.getCellSelection()) {
      rowsToDelete.add((RowData)cell.row);
    }
  }
  if (rowsToDelete.isEmpty()) {
    return;
  }
  int rowsRemoved=0;
  int lastRowNum=-1;
  for (  RowData row : rowsToDelete) {
    if (model.deleteRow(row)) {
      rowsRemoved++;
    }
    lastRowNum=row.visualNumber;
  }
  if (gridMode == GridMode.GRID && lastRowNum < spreadsheet.getItemCount() - 1) {
    GridCell newPos=new GridCell(curAttribute,model.getRow(lastRowNum - rowsRemoved + 1));
    spreadsheet.setCursor(newPos,false);
  }
  if (rowsRemoved > 0) {
    refreshSpreadsheet(true);
  }
 else {
    spreadsheet.redrawGrid();
  }
  updateEditControls();
  fireResultSetChange();
}
