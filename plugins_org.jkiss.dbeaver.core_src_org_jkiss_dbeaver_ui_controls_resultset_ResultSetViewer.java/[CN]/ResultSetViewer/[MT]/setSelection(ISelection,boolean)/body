{
  if (selection instanceof ResultSetSelectionImpl && ((ResultSetSelectionImpl)selection).getResultSetViewer() == this) {
    return;
  }
  spreadsheet.deselectAll();
  if (!selection.isEmpty() && selection instanceof IStructuredSelection) {
    List<GridPos> cellSelection=new ArrayList<GridPos>();
    for (Iterator iter=((IStructuredSelection)selection).iterator(); iter.hasNext(); ) {
      Object cell=iter.next();
      if (cell instanceof GridPos) {
        cellSelection.add((GridPos)cell);
      }
 else {
        log.warn("Bad selection object: " + cell);
      }
    }
    spreadsheet.selectCells(cellSelection);
    if (reveal) {
      spreadsheet.showSelection();
    }
  }
  fireSelectionChanged(new SelectionChangedEvent(this,selection));
}
