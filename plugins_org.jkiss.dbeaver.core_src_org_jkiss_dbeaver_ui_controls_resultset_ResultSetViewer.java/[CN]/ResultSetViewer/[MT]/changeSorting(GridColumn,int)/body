{
  DBDDataFilter dataFilter=model.getDataFilter();
  boolean ctrlPressed=(state & SWT.CTRL) == SWT.CTRL;
  boolean altPressed=(state & SWT.ALT) == SWT.ALT;
  if (ctrlPressed) {
    dataFilter.resetOrderBy();
  }
  DBDAttributeBinding metaColumn=model.getVisibleColumn(column.getIndex());
  DBDAttributeConstraint constraint=dataFilter.getConstraint(metaColumn);
  if (constraint.getOrderPosition() == 0) {
    if (dataReceiver.isHasMoreData() && supportsDataFilter()) {
      if (!ConfirmationDialog.confirmActionWithParams(spreadsheet.getShell(),PrefConstants.CONFIRM_ORDER_RESULTSET,metaColumn.getAttributeName())) {
        return;
      }
    }
    constraint.setOrderPosition(dataFilter.getMaxOrderingPosition() + 1);
    constraint.setOrderDescending(altPressed);
  }
 else   if (!constraint.isOrderDescending()) {
    constraint.setOrderDescending(true);
  }
 else {
    for (    DBDAttributeConstraint con2 : dataFilter.getConstraints()) {
      if (con2.getOrderPosition() > constraint.getOrderPosition()) {
        con2.setOrderPosition(con2.getOrderPosition() - 1);
      }
    }
    constraint.setOrderPosition(0);
    constraint.setOrderDescending(false);
  }
  reorderResultSet(constraint.getOrderPosition() == 0,new Runnable(){
    @Override public void run(){
      resetColumnOrdering();
    }
  }
);
}
