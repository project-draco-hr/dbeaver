{
  if (adapter == IFindReplaceTarget.class) {
    return findReplaceTarget;
  }
  if (adapter.isAssignableFrom(activePresentation.getClass())) {
    return activePresentation;
  }
  if (activePresentation instanceof IAdaptable) {
    return ((IAdaptable)activePresentation).getAdapter(adapter);
  }
  return null;
}
