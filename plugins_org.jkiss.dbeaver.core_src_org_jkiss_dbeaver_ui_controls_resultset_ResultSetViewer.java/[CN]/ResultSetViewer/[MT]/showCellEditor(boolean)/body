{
  final GridPos focusCell=spreadsheet.getFocusCell();
  if (focusCell == null || focusCell.row < 0 || focusCell.col < 0) {
    return false;
  }
  if (!isValidCell(focusCell)) {
    return false;
  }
  GridPos cell=translateGridPos(focusCell);
  if (cell.row < 0 || cell.row >= curRows.size() || cell.col < 0 || cell.col >= metaColumns.length) {
    log.debug("Editor position is out of bounds (" + cell.col + ":"+ cell.row+ ")");
    return false;
  }
  if (!inline) {
    for (    ResultSetValueController valueController : openEditors.keySet()) {
      GridPos cellPos=valueController.getCellPos();
      if (cellPos != null && cellPos.equalsTo(cell)) {
        openEditors.get(valueController).showValueEditor();
        return true;
      }
    }
  }
  DBDAttributeBinding metaColumn=metaColumns[cell.col];
  if (isColumnReadOnly(metaColumn) && inline) {
    return false;
  }
  final int handlerFeatures=metaColumn.getValueHandler().getFeatures();
  if (handlerFeatures == DBDValueHandler.FEATURE_NONE) {
    return false;
  }
  Composite placeholder=null;
  if (inline) {
    if (isReadOnly()) {
      return false;
    }
    spreadsheet.cancelInlineEditor();
    placeholder=new Composite(spreadsheet,SWT.NONE);
    placeholder.setFont(spreadsheet.getFont());
    placeholder.setLayout(new FillLayout());
    GridData gd=new GridData(GridData.FILL_BOTH);
    gd.horizontalIndent=0;
    gd.verticalIndent=0;
    gd.grabExcessHorizontalSpace=true;
    gd.grabExcessVerticalSpace=true;
    placeholder.setLayoutData(gd);
  }
  ResultSetValueController valueController=new ResultSetValueController(curRows.get(cell.row),cell.col,inline ? DBDValueController.EditType.INLINE : DBDValueController.EditType.EDITOR,inline ? placeholder : null);
  final DBDValueEditor editor;
  try {
    editor=metaColumn.getValueHandler().createEditor(valueController);
  }
 catch (  Exception e) {
    UIUtils.showErrorDialog(site.getShell(),"Cannot edit value",null,e);
    return false;
  }
  if (editor instanceof DBDValueEditorDialog) {
    valueController.registerEditor((DBDValueEditorDialog)editor);
    new UIJob("Open separate editor"){
      @Override public IStatus runInUIThread(      IProgressMonitor monitor){
        ((DBDValueEditorDialog)editor).showValueEditor();
        return Status.OK_STATUS;
      }
    }
.schedule();
  }
 else {
    if (editor != null) {
      editor.refreshValue();
    }
  }
  if (inline) {
    if (editor != null) {
      spreadsheet.showCellEditor(focusCell,placeholder);
    }
 else {
      placeholder.dispose();
    }
  }
  return editor != null;
}
