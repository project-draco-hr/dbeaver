{
  DBDAttributeBinding attr=(DBDAttributeBinding)(rowElement instanceof DBDAttributeBinding ? rowElement : colElement);
  RowData row=(RowData)(colElement instanceof RowData ? colElement : rowElement);
  int rowNum=row.getVisualNumber();
  Object value=getModel().getCellValue(attr,row);
  if (rowNum > 0 && rowNum == model.getRowCount() - 1 && (recordMode || spreadsheet.isRowVisible(rowNum)) && dataReceiver.isHasMoreData()) {
    readNextSegment();
  }
  if (formatString) {
    return attr.getValueHandler().getValueDisplayString(attr.getAttribute(),value,DBDDisplayFormat.UI);
  }
 else {
    return value;
  }
}
