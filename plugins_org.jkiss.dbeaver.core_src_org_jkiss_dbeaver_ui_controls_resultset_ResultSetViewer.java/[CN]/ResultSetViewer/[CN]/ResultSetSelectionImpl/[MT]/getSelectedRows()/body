{
  List<ResultSetRow> rows=new ArrayList<ResultSetRow>();
  if (mode == ResultSetMode.RECORD) {
    if (curRowNum < 0 || curRowNum >= model.getRowCount()) {
      return Collections.emptyList();
    }
    rows.add(new ResultSetRow(ResultSetViewer.this,model.getRowData(curRowNum)));
  }
 else {
    Collection<Integer> rowSelection=spreadsheet.getRowSelection();
    for (    Integer row : rowSelection) {
      rows.add(new ResultSetRow(ResultSetViewer.this,model.getRowData(row)));
    }
  }
  return rows;
}
