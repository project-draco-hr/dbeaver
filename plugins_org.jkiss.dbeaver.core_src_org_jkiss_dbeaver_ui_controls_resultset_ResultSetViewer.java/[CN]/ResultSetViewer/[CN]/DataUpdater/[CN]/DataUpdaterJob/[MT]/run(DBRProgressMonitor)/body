{
  ResultSetViewer.this.updateInProgress=true;
  try {
    final Throwable error=executeStatements(monitor);
    UIUtils.runInUI(ResultSetViewer.this.site.getShell(),new Runnable(){
      @Override public void run(){
        boolean rowsChanged=false;
        if (DataUpdaterJob.this.autocommit || error == null) {
          rowsChanged=reflectChanges();
        }
        if (!getControl().isDisposed()) {
          refreshSpreadsheet(rowsChanged);
          updateEditControls();
          if (error == null) {
            setStatus(NLS.bind(CoreMessages.controls_resultset_viewer_status_inserted_,new Object[]{DataUpdaterJob.this.insertCount,DataUpdaterJob.this.deleteCount,DataUpdaterJob.this.updateCount}));
          }
 else {
            UIUtils.showErrorDialog(ResultSetViewer.this.site.getShell(),"Data error","Error synchronizing data with database",error);
            setStatus(error.getMessage(),true);
          }
        }
        fireResultSetChange();
      }
    }
);
    if (this.listener != null) {
      this.listener.onUpdate(error == null);
    }
  }
  finally {
    ResultSetViewer.this.updateInProgress=false;
  }
  return Status.OK_STATUS;
}
