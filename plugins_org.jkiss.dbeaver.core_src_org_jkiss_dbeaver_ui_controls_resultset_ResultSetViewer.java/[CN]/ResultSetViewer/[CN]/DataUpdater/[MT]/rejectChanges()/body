{
  if (editedValues != null) {
    for (    GridPos cell : editedValues.keySet()) {
      Object[] row=ResultSetViewer.this.curRows.get(cell.row);
      resetValue(row[cell.col]);
      row[cell.col]=editedValues.get(cell);
    }
    editedValues.clear();
  }
  boolean rowsChanged=cleanupRows(addedRows);
  if (removedRows != null) {
    removedRows.clear();
  }
  refreshSpreadsheet(rowsChanged);
  fireResultSetChange();
}
