{
  super(parent,checkStyle(style));
  sizingGC=new GC(this);
  topLeftRenderer=new DefaultTopLeftRenderer(this);
  bottomLeftRenderer=new DefaultBottomLeftRenderer(this);
  rowHeaderRenderer=new DefaultRowHeaderRenderer(this);
  emptyColumnHeaderRenderer=new DefaultEmptyColumnHeaderRenderer(this);
  emptyColumnFooterRenderer=new DefaultEmptyColumnFooterRenderer(this);
  emptyCellRenderer=new DefaultEmptyCellRenderer(this);
  emptyRowHeaderRenderer=new DefaultEmptyRowHeaderRenderer(this);
  setForeground(getDisplay().getSystemColor(SWT.COLOR_LIST_FOREGROUND));
  setLineColor(getDisplay().getSystemColor(SWT.COLOR_WIDGET_BACKGROUND));
  if ((style & SWT.MULTI) != 0) {
    selectionType=SWT.MULTI;
  }
  if (getVerticalBar() != null) {
    getVerticalBar().setVisible(false);
    vScroll=new ScrollBarAdapter(getVerticalBar());
  }
 else {
    vScroll=new NullScrollBar();
  }
  if (getHorizontalBar() != null) {
    getHorizontalBar().setVisible(false);
    hScroll=new ScrollBarAdapter(getHorizontalBar());
  }
 else {
    hScroll=new NullScrollBar();
  }
  scrollValuesObsolete=true;
  initListeners();
  itemHeight=sizingGC.getFontMetrics().getHeight() + 3;
  RGB sel=getDisplay().getSystemColor(SWT.COLOR_LIST_SELECTION).getRGB();
  RGB white=getDisplay().getSystemColor(SWT.COLOR_WHITE).getRGB();
  RGB cellSel=blend(sel,white,50);
  cellHeaderSelectionBackground=new Color(getDisplay(),cellSel);
  setDragDetect(false);
}
