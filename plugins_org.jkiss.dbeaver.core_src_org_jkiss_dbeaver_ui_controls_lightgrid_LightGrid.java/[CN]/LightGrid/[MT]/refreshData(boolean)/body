{
  if (clearData) {
    this.removeAll();
  }
  IGridContentProvider contentProvider=getContentProvider();
  this.columnElements=contentProvider.getElements(true);
  this.rowElements=contentProvider.getElements(false);
  this.displayedToolTipText=null;
  if (clearData) {
    this.topIndex=-1;
    this.bottomIndex=-1;
    this.maxColumnDepth=0;
    for (    Object columnElement : columnElements) {
      GridColumn column=new GridColumn(this,columnElement);
      createChildColumns(column);
    }
    if (getColumnCount() == 1) {
      GridColumn column=getColumn(0);
      int columnWidth=column.computeHeaderWidth();
      int gridWidth=getSize().x - getRowHeaderWidth() - getHScrollSelectionInPixels()- getVerticalBar().getSize().x;
      if (gridWidth > columnWidth) {
        columnWidth=gridWidth;
      }
      column.setWidth(columnWidth);
    }
 else {
      int totalWidth=0;
      for (      GridColumn curColumn : columns) {
        curColumn.pack();
        totalWidth+=curColumn.getWidth();
      }
      int clientWidth=getClientArea().width;
      if (totalWidth > clientWidth) {
        int normalWidth=0;
        List<GridColumn> fatColumns=new ArrayList<GridColumn>();
        for (        GridColumn curColumn : columns) {
          if (curColumn.getWidth() > maxColumnDefWidth) {
            fatColumns.add(curColumn);
          }
 else {
            normalWidth+=curColumn.getWidth();
          }
        }
        if (!fatColumns.isEmpty()) {
          int freeSpace=(clientWidth - normalWidth - getBorderWidth()- rowHeaderWidth- vScroll.getWidth()) / fatColumns.size();
          int newFatWidth=(freeSpace > maxColumnDefWidth ? freeSpace : maxColumnDefWidth);
          for (          GridColumn curColumn : fatColumns) {
            curColumn.setWidth(newFatWidth);
          }
        }
      }
    }
  }
  updateScrollbars();
}
