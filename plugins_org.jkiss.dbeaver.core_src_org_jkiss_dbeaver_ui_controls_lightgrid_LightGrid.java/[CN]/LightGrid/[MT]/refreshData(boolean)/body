{
  if (clearData) {
    this.removeAll();
  }
  IGridContentProvider contentProvider=getContentProvider();
  IGridLabelProvider labelProvider=getColumnLabelProvider();
  this.columnElements=contentProvider.getElements(true);
  this.rowElements=contentProvider.getElements(false);
  if (clearData) {
    this.topIndex=-1;
    this.bottomIndex=-1;
    for (int i=0; i < columnElements.length; i++) {
      GridColumn column=new GridColumn(this,columnElements[i]);
      column.setText(labelProvider.getText(columnElements[i]));
      column.setImage(labelProvider.getImage(columnElements[i]));
      column.setHeaderTooltip(labelProvider.getTooltip(columnElements[i]));
    }
    if (getColumnCount() == 1) {
      GridColumn column=getColumn(0);
      int columnWidth=column.computeHeaderWidth();
      int gridWidth=getSize().x - getRowHeaderWidth() - getHScrollSelectionInPixels()- getVerticalBar().getSize().x;
      if (gridWidth > columnWidth) {
        columnWidth=gridWidth;
      }
      column.setWidth(columnWidth);
    }
 else {
      int totalWidth=0;
      for (      GridColumn curColumn : columns) {
        curColumn.pack();
        totalWidth+=curColumn.getWidth();
      }
      int clientWidth=getClientArea().width;
      if (totalWidth > clientWidth) {
        int normalWidth=0;
        List<GridColumn> fatColumns=new ArrayList<GridColumn>();
        for (        GridColumn curColumn : columns) {
          if (curColumn.getWidth() > maxColumnDefWidth) {
            fatColumns.add(curColumn);
          }
 else {
            normalWidth+=curColumn.getWidth();
          }
        }
        if (!fatColumns.isEmpty()) {
          int freeSpace=(clientWidth - normalWidth - getBorderWidth()- rowHeaderWidth- (vScroll.getControl() == null ? 0 : vScroll.getControl().getSize().x)) / fatColumns.size();
          int newFatWidth=(freeSpace > maxColumnDefWidth ? freeSpace : maxColumnDefWidth);
          for (          GridColumn curColumn : fatColumns) {
            curColumn.setWidth(newFatWidth);
          }
        }
      }
    }
  }
 else {
    for (int i=0; i < columns.size(); i++) {
      GridColumn column=columns.get(i);
      column.setText(labelProvider.getText(columnElements[i]));
      column.setImage(labelProvider.getImage(columnElements[i]));
      column.setHeaderTooltip(labelProvider.getTooltip(columnElements[i]));
    }
  }
  updateScrollbars();
}
