{
  checkWidget();
  if (endColumnIndex != -1) {
    return endColumnIndex;
  }
  if (columns.isEmpty()) {
    endColumnIndex=0;
  }
 else   if (getVisibleGridWidth() < 1) {
    endColumnIndex=getStartColumnIndex();
  }
 else {
    int x=0;
    x-=getHScrollSelectionInPixels();
    if (rowHeaderVisible) {
      x+=rowHeaderWidth;
    }
    int startIndex=getStartColumnIndex();
    for (int i=startIndex; i < columns.size(); i++) {
      endColumnIndex=i;
      GridColumn column=columns.get(i);
      x+=column.getWidth();
      if (x > getClientArea().width) {
        break;
      }
    }
  }
  endColumnIndex=Math.max(0,endColumnIndex);
  return endColumnIndex;
}
